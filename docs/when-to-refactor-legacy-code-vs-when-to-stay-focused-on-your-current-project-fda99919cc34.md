# 何时重构遗留代码，何时专注于当前项目

> 原文：<https://www.freecodecamp.org/news/when-to-refactor-legacy-code-vs-when-to-stay-focused-on-your-current-project-fda99919cc34/>

作者:黄思慧

# 何时重构遗留代码，何时专注于当前项目

![1*qw5zQRKKw4pNbhv3nwjIjQ](img/842b21fd8da4a8a055cc7ba0d6e001c6.png)

当我从事项目时，我经常会遇到可以改进的遗留代码——更易读、更易测试，或者更符合当前的编码风格。在花了大量时间试图理解一段晦涩难懂的代码后，我重构代码的冲动特别强烈。[那段代码伤脑](https://www.sihui.io/brain-friendly-code/)，我不希望同样的事情发生在其他开发者身上。有一个著名的童子军规则:**留下比你发现的更好的代码**。

但与此同时，我也想保持专注，并在当前的项目上取得进展。我担心我会分心，花太多时间去重构。

这是我经常面临的困境。我想成为一名乐善好施的人，把代码写得比我发现的更好，成为一名工程师，把我遇到的所有乱七八糟的代码变成干净优雅的东西。但我也想保持务实，快速交付项目。

在重构我遇到的遗留代码和专注于当前项目之间保持平衡可能很难。

最近与我的经理就此话题进行的一次谈话为我找到平衡提供了指导。以下几点我觉得很有帮助。

#### **你不必让代码完美。小的改进还是有用的。**

当我读完一段遗留代码后，我的大脑会立即思考它应该是怎样的。但是将代码从当前状态重构到理想状态有时需要大量的重构工作。在最好的情况下，所需的重构可能非常耗时。在最糟糕的情况下，它可能会变成一个兔子洞，导致项目的重大延误。

当我面对这种情况时，我通常要么冒险进行大规模的重构，要么捏着鼻子让代码保持恶臭。现在我意识到有一个令人高兴的中间点:**我没有让代码变得完美。我可以花尽可能多或尽可能少的时间让代码变得更好。**

我所做的一些小的改进对于接下来的开发者来说仍然是有用的。那些开发人员可能有时间在我所做的改进的基础上进一步改进代码。

(PS:没有完美也没有理想的代码。当你做出改变的时候，你会发现你可以做更多的改进。)

#### 给你的重构设定时间框。

时间拳击是避免兔子洞的好方法。在开始重构之前，做一个快速的估算，在不太延迟项目的情况下，你能在重构遗留代码上花费多少时间。写下那个数字。

对你的重构进行时间限制可以让你安心，因为你知道主项目会保持在正轨上。这使得重构体验更加愉快。

#### 将重构时间融入到项目评估中。

如果在开始一个项目之前，将重构时间融入到项目评估中，事情会变得更加简单。在估计一个项目可能需要多少时间的时候，快速看一下你需要接触的代码:它第一次是什么时候写的？可读性和可扩展性如何？它有多大的测试覆盖率？除非对项目何时交付有硬性要求，否则您应该在项目的时间表中预留一些重构时间。

毕竟，当我们继续在遗留代码基础上构建时，重构它是保持它健康的最佳方式。健康的代码库反过来会让构建新特性更快更安全。

#### 重构具有教育意义。

重构一段代码是理解它的最好方法。与置身事外、只是阅读一段代码相比，走进来修改它会让你与代码有更深更亲密的关系。

当你试图在代码中加入你的风格时，你会开始注意到你以前忽略的东西。您可能会看到约束，甚至可能会理解作者最初为什么这样写代码。

虽然重构一段代码似乎不会给企业带来任何直接的价值，但这是你获得一段你目前没有的领域知识的机会。获得该领域的知识对你和企业都是无价的。

#### **重构是你可以锻炼的肌肉**

你做得越多，你就变得越快。重构遗留代码的最后一个原因是把它作为增强你“重构肌肉”的机会。投资打造你的“重构肌肉”有一个自我强化的复合效应:**你重构得越多，你就越擅长重构，让你的下一次重构更快。**做得越多，代码库就越好，从而更快地构建未来的功能。

幸运的是，我的下一个项目与三年前的代码有关。我预计会遇到很多情况，需要我在重构遗留代码和项目进展之间进行平衡。我会在我的个人博客上分享我的新学习。订阅跟随！

我今年的职业规划是成长为一名技术主管。我对未来的学习感到兴奋，并愿意以一种残酷诚实的方式与你分享这一旅程。我将在我的[个人博客](https://www.sihui.io)(非中型)上分享我每周的学习。

在接下来的几个月里，我将专注于以下领域的发展，所以你可以期待看到与它们相关的帖子:

*   着眼于项目的大局，而不是近期的实施细节；
*   在领导项目和编码之间平衡我的努力；
*   长期生产力的工作生活平衡；
*   软件开发中人的一面:确保每个和我一起的人都享受这一过程，并感到充实和受鼓舞。

*原载于[www . sihui . io](https://www.sihui.io/refactoring-vs-staying-focused/)2019 . 2 . 1。*