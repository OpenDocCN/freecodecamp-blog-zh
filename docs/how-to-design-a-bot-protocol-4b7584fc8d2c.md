# 如何设计一个机器人协议

> 原文：<https://www.freecodecamp.org/news/how-to-design-a-bot-protocol-4b7584fc8d2c/>

亚历克斯·布纳季奇

# 如何设计一个机器人协议

![HgTPUwIStS4m3NjPF6hKr9bPdZTf8XW4Bwjz](img/635658e2d39277de9fc4fc5db6acf34f.png)

关于当前机器人热潮的最大谬误之一是，机器人需要能够提供细致入微、复杂的对话体验([你的机器人怎么说‘番茄酱’？](https://medium.com/hh-design/how-does-your-bot-say-ketchup-9bdc3fd3cb86#.4jacwzd65))。那种情绪完全没有事实依据，很可能是基于看了太多花哨的好莱坞科幻电影。

事实上，机器人仅仅是我们在各种社会情境中可以观察到的常规人类行为的延伸。因为机器人是我们进行自动化信息处理的许多方式中的另一种，它们遵守与其他软件产品完全相同的约束。总之，机器人遵守某种行为模式，即所谓的*通信协议*。

#### 什么是协议？

当双方通信时，他们通过交换消息来进行。这个信息传递的过程可能很简单，就像发送烟雾信号一样:

![hmrtVClqLTtO3gDgzZPZMvNK--mf9CGX4zE8](img/121bd2140f8a52dcb2a1c2aafd85f153.png)

或者，它可以更高级，更简单，例如打电话或发短信。

无论使用何种机制来交换消息，真正关键的是所有相关方对每条消息的含义达成一致和理解。在所有这些场景中，最重要的是避免自由形式的、松散的闲聊。

考虑当飞行员接近空中交通控制塔时发生的典型消息交换。在这种危险的情况下，允许飞行员和空中交通管制员进行开放式的、无组织的玩笑是极其危险的。相反，它们遵循预定义的、预定的通信协议。

飞行员或交通管制员说的每句话都以关键字“结束”结尾。该关键字向另一方发出信号，表明正在讲话的人已经结束了讲话，现在正全神贯注地听着。此外，做倾听的人总是以关键字“罗杰”(或“目前为止罗杰”)开始他们的谈话，表明他们已经完全理解了对方在说什么(有时“罗杰”可以用“wilco”代替，暗示“将遵守”，意味着信息被响亮而清晰地接收到)。

从上面的例子中可以明显看出，在高度危险的情况下(比如飞机着陆)实现的通信协议必然是极其受限和严格的。不允许交换的消息在语法上有任何偏差。严格遵守这些规则可以确保清晰、无障碍的交流。

#### 不太紧急情况下的协议

并不是所有人们交流的情况都像飞机着陆一样危急和危险。尽管如此，这并不一定意味着在不太紧张的情况下处理沟通问题时可以不顾一切。

想一想人们在穿越边境时是如何交流的。在接近边境时，旅客会受到过境官员的询问。谈话的基调是由官员定的，旅行者最好遵从并听从官员的领导。这意味着用简短、尖锐的句子回答所有问题，通常用简洁的“是”或“不是”语句。这种即兴制定的协议确保了顺利和有效的过境，同时允许安全官员顺利履行职责。

大多数人似乎在领会这些暗示方面没有任何问题，并且通常毫无困难地遵循提议的即兴协议。

或者，考虑一个更不重要的情况，例如当我们参加某种社交活动(例如，在剧院的一个晚上)时出现的通信协议。一进入剧院，我们就受到礼宾员的迎接。是礼宾员设定了谈话的基调，大多数人都很乐意遵从。这种遵守确保了平稳有效的服务，因为我们受到欢迎，随后被带进大楼。在我们被领去衣帽间之前，我们简短而礼貌地交谈了几句，然后被带到我们的座位上。

#### 协议决定了对话的基调

不管谈话有多激烈，或者有多轻松，总有一个潜在的，通常是心照不宣的沟通协议。即使在休闲购物时，我们也会注意到顾客和店员之间的对话多少遵守了某种正式的交流协议。

通常情况下，缺乏社交技能和不遵守那些默认协议的人会被认为是令人讨厌和不愉快的。因此，我们看到，遵守预先建立的协议是良好调整行为的标志。

它通常也是服务的一方(如医生办公室的接待员，或社交活动的主人等)。)谁来设定协议和对话的基调。如果有任何硬性规定必须插入谈话中，这些规定会在谈话一开始就提出来。通过提出任何规则，服务方设定了对话的正式基调，然后还负责处理会话期间可能出现的任何问题、例外和异常情况。

需要注意的重要一点是，这种预先设定的语气对我们来说是多么自然、多么正常。每当我们发现自己处于没有心照不宣的规则和特定协议的情况下，我们往往会感到不安，不知道下一步该怎么走。

#### 机器人必须设置协议

尽管最近有一些令人兴奋和夸张的说法，但机器人的主流出现并不是革命性的技术进步。主流机器人仅仅是我们定期和持续尝试尽可能多地自动化日常任务的进化延伸。

事实上，机器人和老式的 GUI 应用程序并没有什么不同。回想一下，每当我们登录 GUI 应用程序时，我们是如何遵守特定的通信协议的。这款应用为我们的体验定下了基调，并引导着我们。GUI 应用程序和机器人之间的唯一区别是，使用 GUI(顾名思义)，底层服务呈现给我们的大多数消息都是图片/图形的。有了机器人，底层服务呈现给我们的大多数消息都是文本的。

如果我们从 GUI 应用程序的表面开始，我们会意识到所有这些图形表示实际上都被翻译成文本命令，然后被发送到后端服务进行处理。例如，如果我正在与一个机器人通信，我可以说:“让我知道我的订单的状态。”如果我正在与 GUI 应用程序通信，我可以点击“订单状态”链接，浏览器会将该操作转换为文本语句，类似于“GET[http://domain.com/user/1/order?id=42](http://domain.com/user/1/order?id=42)HTTP/1.1”。在这两种情况下(GUI 和 bot)，响应将以文本形式返回。一样的区别，真的。

唯一的实质性区别是，当与机器人通信时，我可以依靠我对自然语言的直觉，而如果我想向 GUI 应用程序发送文本消息，我必须接受正式培训，了解如何制定后端服务可以理解的语法正确的字符串。

但是要点仍然存在 GUI 应用程序和机器人都设置了通信协议和基调。确定基调的肯定是*而不是*用户。用户要么遵守提议的协议并遵从对话的基调，要么沮丧地放弃所有享受可用服务的尝试。

这第一遍听起来可能很粗鲁和不体贴，但实际上这是一件可取的事情。正如我们所见，如果不通过设定基调和定义一些基本规则来建立清晰的界限，清晰、明确和连贯的沟通是绝对不可能的。否则，我们可能会面临这样的危险:系统陷入混乱，对最终用户和提供服务的企业都没有好处。

#### 企业看重什么？

如果你负责经营一家企业，那么你很可能会同意这样的说法，即商业中最重要的事情之一是*可预测性*。没有人喜欢处于不确定的境地，尤其是如果许多其他人的未来可能处于危险之中。

这就是为什么在向企业提供自动化服务时建立信任至关重要。企业愿意投资的任何服务都必须提供可预测性和可重复性的可靠保证。总之，自动化服务必须提供连贯、一致、完全可控的行为。

正是因为这种主要的商业价值，服务机器人必须具有完全成熟、清晰的通信协议，这些协议明确地设定了对话的基调。作为机器人开发者，我们必须能够向企业证明我们的机器人是完全可预测的。我们只能通过展示它们如何表现出可重复、完全可控的行为来实现这一点。

#### 机器人跟踪用户的互动

机器人区别于传统 GUI 应用的一个重要方面是它们对人类用户的专注。虽然 GUI 应用程序不关心谁在操作它们，但机器人肯定会关心。与 GUI 应用程序不同，GUI 应用程序提出“一刀切”的方法来提供自动化服务，而机器人则提出高度个性化的服务。个性化体现在人类用户和机器人之间的对话线程中。

尽管不同的用户与同一个机器人交互，但是他们的交互历史是完全独特的。不可能有两条相同的讨论线索，信息交换的种类是无穷无尽的。

另一个要点是，机器人保留了每个用户的每个单独步骤的记忆，并可以回忆和总结在给定的上下文中发生的事情。GUI 应用程序从来没有类似的设计意图，这使得它们看起来非常粗糙，相比之下几乎是野蛮的。

#### 机器人和上下文切换

当人类交流时，当对话的上下文发生变化时，他们会用自己的常识技能向对方发出信号。例如，在初次接触时，短暂的上下文(通常称为“见面和问候”)就建立起来了。这种背景通常是通过使用常见的开场白来设定的，比如“嗨，你好吗？”，“你好！”，“你好？”，“你过得怎么样？”等等。根据见面会是发生在陌生人之间还是老朋友之间，开场白可能会有所不同。但总体基调仍然是可以预测的，因为这是一种默契的意图，即迅速结束短暂的见面和问候的局面，转向更具体的互动。

在最初的问候之后，语境通常会突然转换，而这种转换是通过对话语气的变化来表示的。根据会议是非正式的，还是更正式的商务会议，甚至是法律会议，合适的语气会占上风。

无法检测和执行类似上下文切换的机器人是完全无用的机器人。构建一个只能通过始终保持相同的对话语气以简单、下意识的方式行事的机器人不会在用户群中获得太多关注。

由于这种危险，我们需要建立一些关于如何实现一个可靠的、可行的 bot 协议的指导方针。

#### Bot 协议指南

一般来说，任何向人类用户提供对话体验的机器人都必须提供四个级别的通信协议:

1.  *命令协议*
2.  *关键字协议*
3.  *结构化短语协议*
4.  *自由形式(非正式)协议*

上述四种协议是根据其严格性和严格性排序的——从最严格、最严格和最严格的形式(即命令协议)到最不严格和最不正式的形式(随意聊天或戏谑)。

#### 命令协议

对于命令，我们回到命令行界面( [CLI](https://en.wikipedia.org/wiki/Command-line_interface) )。使用命令行界面通常是计算机程序员和系统管理员的领域。这确实需要一定程度的正式培训，因为计算机操作系统并没有考虑到对话体验。命令语法的严格性是必需的，以便底层操作系统能够以尽可能少的歧义执行命令。

在机器人的世界里，这种严格必须被软化，因为目标受众不是受过高度训练的专业人士。不要期望普通用户知道如何表达语法正确的命令。机器人必须充当中介经纪人或礼宾员。这个代理必须能够接受用户发出的命令。然后，代理将命令翻译成语法更正确的形式。后端机器需要语法上正确的形式，这样它就可以处理请求，而不会带来不必要的副作用。

因此，机器人提供的命令必须是单字命令。请记住，机器人还应该对可能不是严格命令的单个单词消息做出响应，我们必须以这样一种方式设计机器人命令，使它们能够立即脱颖而出。通常，这意味着 bot 命令必须以特殊字符开头的方式构造。例如，一个请求机器人提醒它理解哪些命令的命令通常以“/”(正斜杠)字符开头。说' help '和'/help '有语义上的区别。机器人不会将第一条消息(简单的“帮助”)解释为命令。第二条消息(所谓的*斜杠命令* '/help ')被机器人解释为命令。处理该命令的结果将与处理简单的“帮助”消息的结果大不相同。

#### 关键词协议

与机器人命令不同，关键字是用户发送给机器人的不太正式、不太严格的消息。与 bot 命令不同，关键字的主要职责是控制*对话上下文*的切换。

在 bot 命令的情况下，没有上下文切换—bot 识别命令并简单地执行它。用户可以向机器人请求*/帮助*，只要用户愿意，机器人将总是用它理解的完全相同的命令列表来回复。根据用户发出的命令的性质，机器人可能会要求后续确认。但是总会有一些命令被下意识地执行(例如，如果机器人问用户“你确定要我执行 */help* 命令吗？”那就太可笑了)

关键字不同于命令，因为它们旨在提醒机器人对话的上下文已经改变。与命令类似，关键字被格式化为单个单词的指令，并以特殊字符(通常为“@”字符)进行标点。

例如，用户可能正在与机器人讨论吃午餐的最佳地点，这时用户通过说“机器人，请与我的@医生联系，她什么时候有空预约？”来打断上下文在这条消息中， *@doctor* 这个词是触发 bot 理解上下文必须改变的关键词。在收到包含该关键字的消息时，机器人会将上下文从讨论午餐地点切换到计算医生预约的下一个可用时间段。

与命令不同，关键字通信协议通常意味着机器人可能会询问后续问题。由预先建立的 *@keyword* 的存在触发的那些后续问题将总是在新建立的上下文中被询问。在上面的例子中，由于用户拉动了*@医生*关键词并突然切换了上下文，机器人可能会回复一个后续问题(或一系列后续问题，视情况而定)。

取决于机器人是如何被训练的，接下来的问题可能是:“这是一件紧急的事情吗？”，或者可以是:“你有必要去看医生吗？万一你的医生碰巧不在，办公室里的另一位医生可以吗？”或者，如果机器人过于简单，它可能只是继续进行并为最早的可用时段安排约会，而不与用户进行任何进一步的协商。

#### 结构化短语协议

典型的人类对话很少包含简洁的一个词的交流。大多数时候，我们通过交换各种习语和短语来交谈，这些习语和短语是构建更复杂句子的基础。

为了使与机器人聊天的体验感觉直观和自然，我们必须使我们的机器人能够处理短短语，甚至短句。与命令和关键字类似，这些结构化的短语和句子必须由机器人创建者预先定义和设计。

因为习惯用语和短语暗示着更随意的对话语气，所以处理结构化短语的结果必然比命令或单个关键字的结果更不确定。如果你还记得企业是如何反对不可预测性和不确定性结果的，你会更容易理解为什么我们更喜欢将不太关键的处理归入结构化短语。不言而喻，发送给机器人的消息越不结构化、越不正式，机器人以可预测、确定的方式处理消息的能力就越弱。

在这里，我们在向更随意的通信模式开放我们的服务与保证在准确性、精确度、正确性、一致性、连贯性和可重复性方面的最低服务质量之间划出了一条微妙的界限。虽然我们承认随意交流模式的重要性，但是当我们把任何关键的处理委托给那些不太正式的信息时，我们还是会感到忧虑。

另一件使结构化短语处理变得重要的事情是，在服务用户请求时，必须建立自信的步调。如果我们坚持只停留在高度形式化的，一个词的命令和关键词的范围内，我们实际上会以生硬的对话线索结束。如果对话感觉如此僵硬和冷淡，用户将不会感到被迫返回与机器人聊天；我们需要建立一个流程和明确的节奏，让用户参与进来，并最终对服务质量感到满意。

这就是为什么让我们的机器人能够处理人们在日常用语中倾向于使用的一些常用短语是至关重要的。像“你知道什么……”或“你能告诉我关于……”等短语。是我们所有人在日常生活中都会用到的。以这种结构化的短语开始发送消息感觉很正常和自然。然后，机器人将识别出他们收到的消息是一个查询，并将通过深入后端资源来处理该查询。

同样很自然的是，一个不太官方的短语，比如“你知道些什么……”会为答案不必 100%正确定下基调。对话的总体意图比包含命令或关键字的对话要宽松得多。

#### 自由形式(非正式)协议

最后，我们必须预料到用户会发送不符合上述三种协议中任何一种的消息。将会有许多消息不包含命令、关键字，也不包含结构化的预定义短语。这取决于我们，机器人的创造者，来决定如何处理这种非结构化的信息。

处理这种无组织的、模糊的场景的一个方法是完全诚实，并且总是礼貌地回答“我不知道”或者“我不确定我理解了”这样的短语。诚然，这是一个骗局，但至少它是 100%诚实的。

然而，如果机器人总是用生硬的“我不知道”来回答任何非结构化的消息，它们将很快失去对用户的魅力和吸引力。因此，更可取的做法是尝试满足用户的要求，至少尝试回复一些非结构化的消息。

我们现在进入了有时被称为“闲聊”或“戏谑”的领域。戏谑和闲聊在日常生活中经常发生，甚至在一些更正式的场合。只要我们训练我们的机器人向用户发出一个明确的信号，即他们对非结构化信息的闲聊回答也是轻松、非正式的信息，被误解的风险就会最小化。

这就是幽默发挥作用的地方。如果幽默的剂量适当，与机器人聊天可以相当有趣和娱乐。此外，加入一些琐事可以大大有助于打破僵局，保持谈话的重要节奏。

#### 避开兔子洞

当机器人与用户进行非正式聊天时，总是存在明确而现实的危险，即焦点和势头随时可能消失。对话陷入僵局是不可取的，因此我们必须采取预防措施，避免陷入众所周知的兔子洞。

机器人必须被设计成跟踪与用户的非正式聊天，并检测聊天何时到达令人恐惧的不归路。根据不同的环境(以及特定的用户配置文件)，这条不归路会有很大的不同。总的来说，任何以大量非正式的、半开玩笑的信息和戏谑结束的对话都有变得毫无意义的风险。一旦用户意识到他们与机器人的聊天不仅毫无意义，而且是浪费时间，用户就会发展出避免未来互动的倾向。

从机器人设计蓝图的角度来看，为每个对话线程分配“戏谑预算”可能是有用的。这种“戏谑预算”应该可以用用户和机器人之间交换的连续非正式消息的数量来表示。“戏谑预算”也应该是可配置的，以便机器人可以根据情况的要求实时校准。

当给定的对话线程耗尽其“戏谑预算”时，机器人必须打破众所周知的玻璃，并按下众所周知的紧急按钮。这种使电线跳闸的事件不能让用户看到。当按下紧急按钮时，机器人所做的只是发出一条消息，试图将对话带回到更结构化的路径上。有许多可能的方法来实现这一点，例如，一种方法是机器人插入并礼貌地提醒用户一些对他们可用的更结构化的服务。该机器人还可以在这一点上提供可用命令，可用关键字，甚至常见的结构化短语的复习。这实际上是一个非常有用的行为模式，因为在大多数情况下，用户肯定已经忘记了那些烦人的细节。

有用的短语，如“嘿，你知道你可以让我通知你某某交易吗？”可以用来把谈话从因发送太多蹩脚的敲门笑话而产生的沉闷中拉出来。

#### 机器人必须是非侵入性的

当我建造我的第一个机器人并在野外试用时，我注意到大多数人主要都在与信任问题作斗争。这些问题的部分原因是人们显然没有理解机器人仅仅是现有自动化服务的延伸。

令我惊讶的是，一些人向我透露他们不喜欢机器人坐在那里，偷听他们的所有活动。他们不明白机器人只能访问直接发送给他们的信息，所以这是我为了让他们尝试机器人而不得不通过的另一个障碍。

我发现的一个缓解人们对机器人焦虑的方法是提供一个非常明确的服务水平协议(SLA)。当用户接近机器人时，机器人有责任向用户解释，机器人只能访问直接发送给它的消息。此外，如果机器人非常清楚地解释它永远不会向用户发送消息，除非用户首先向它发送消息，这也会有所帮助。

#### 选择加入和退出

类似于市场如何被监管，以给予我们，消费者，选择加入或不被企业联系的权力(无论是通过电话营销还是垃圾邮件等。)，机器人也必须提供同样的能力。默认情况下，机器人不应该给我们发送任何消息。他们只是对我们发送给他们的信息做出回应。

然而，在很多情况下，我们这些最终用户会从机器人的联系中受益。但是为了实现这一点，必须对机器人进行配置，明确要求用户允许它向用户发送消息。此外，bot 的义务是使用户能够设置他们的偏好，即何时以及如何传递来自 bot 的消息。

#### 结论

机器人被市场普遍接受的唯一方式是建立一个清晰的、可预测的通信协议。在本文中，我认为机器人协议可以而且必须有细微的差别，从最严格和受约束的(命令)到最灵活、不受约束的玩笑。

这种限制的原因在于建立和维护可预测性、可重复性和一致性的迫切需要。这些功能有助于企业对未来进行预测和规划，因此普遍鄙视那些“创新”、“有创造力”、充满惊喜(既有愉快的也有不愉快的)的机器人。

除非我们正在构建一个能够提供一些娱乐价值的机器人(例如单口相声机器人)，否则我们必须确保我们的机器人实现了一组非常严格的命令、关键字、结构化短语和其他能够可靠地展示给用户的功能。

*好奇？想了解更多关于机器人革命的信息吗？在这里阅读更详细的解释:*

[自助时代即将结束](https://medium.freecodecamp.com/the-age-of-self-serve-is-coming-to-an-end-ae632f7151b2#.tjlvovkhc)
[只有 Ux 没有好的 UX](https://medium.com/bots-for-business/https-medium-com-alexbunardzic-only-no-ux-is-good-ux-c24a7cbd12f4#.aqpbs89oj)
[停止建造蹩脚的僵尸程序！](https://medium.com/bots-for-business/stop-building-lame-bots-b093dcd5f28b#.c3k9kcprv)
[四类 bot](https://chatbotsmagazine.com/four-types-of-bots-432501e79a2f#.9tuz1winx)
[对话式界面有没有不好的一面？](https://chatbotsmagazine.com/is-there-a-downside-to-conversational-interfaces-55bed7220c2f#.l43a0r4j4)
[机器人只是一时的流行吗？GUI 真的优越吗？](https://medium.com/@alexbunardzic/are-bots-just-a-fad-are-guis-really-superior-a1f52007d2b9#.a7zvp7kx2)
[打破软件中的第四堵墙](https://medium.freecodecamp.com/breaking-the-fourth-wall-in-software-d08a25df34b7#.jvkf8g6e2)
[bot 是反 app](https://medium.com/bots-for-business/bots-are-the-anti-apps-869639cfa179#.gf5x3rw22)
[bot 需要多少 NLP？](https://medium.com/bots-for-business/how-much-nlp-do-bots-need-a9fd55d64094#.9r83gcpve)
[屏幕是用来消费的，不是用来互动的](https://medium.com/bots-for-business/screens-are-for-consumption-not-for-interaction-6151fb8db6d7#.4qh22p38n)