# Jest 测试驱动开发快速入门

> 原文：<https://www.freecodecamp.org/news/a-quick-introduction-to-test-driven-development-with-jest-cac71cb94e50/>

尼古拉斯·米切尔

本文简单介绍了如何使用 Jest 将测试驱动开发(TDD)原则应用到 JavaScript 练习中。

### 介绍

经过几年的个人项目开发经验，我最近决定成为一名全栈开发人员。

这种新的情况鼓励我开始思考我一直忽视的实践，比如测试我的代码。

这就是为什么我想通过测试驱动开发开始我的旅程。我决定在这里与你分享我的第一步。

### 练习

我决定从第一个 Osherove TDD 形开始。您可以点击查看完整练习[。](http://osherove.com/tdd-kata-1/)

我们的目标是提供一个函数，它接受一个字符串条目(`"1, 2, 3"`)并返回所有数字的和。

我们的项目将具有以下结构:

```
js-kata-jest/
```

```
├─ src/
```

```
 └─ kata.js
```

```
├─ test/
```

```
 └─ kata.test.js
```

```
└─ package.json
```

### 设置测试环境

首先，我们必须设置测试环境。作为一名 React 开发者，我决定选择 [Jest](https://facebook.github.io/jest/) 。您可以使用您选择的任何其他测试库。

#### 正在安装 Jest 开发依赖项

```
yarn add --dev jest
```

或者用 [npm](https://www.npmjs.com/) :

```
npm install --save-dev jest
```

#### 在代码编辑器上激活 Jest

我使用 Atom 作为代码编辑器，并安装了 [tester-jest](https://atom.io/packages/tester-jest) 包。这允许我在保存任何`*.test.js`文件时运行我的测试。

### 测试驱动开发

TDD 背后的理论非常简单，围绕着 3 个步骤:

1.  为一小部分功能编写测试，并检查这个新测试是否失败(红色步骤)
2.  编写通过测试的代码，然后检查您之前的测试和新的测试是否成功(绿色步骤)
3.  重构代码，以确保它清晰、易懂，并且与之前的功能配合良好

在下一部分中，我们将详细介绍每个步骤。

### 解答练习题

#### 第一循环

首先，我们希望处理这样的情况:我们的`add`函数被给定一个空字符串或者一个只有一个元素的字符串。

1.  **编写测试**

*   第一个测试检查空字符串是否返回 0
*   第二个检查单个元素字符串是否返回所提供的元素

**2。编写代码**

*   首先，我们默认返回 0
*   然后我们提供一个`if`语句来处理单个元素的解析

以下是最终代码:

**3。重构代码**

由于这是我们的第一个功能，我们现在可以跳过这一步，但我们很快就会回到这个问题上。；)

#### 第二循环

我们现在将处理字符串包含多个元素的情况:

1.  **编写测试**

新测试确保多元素字符串的计算正确完成:

**2。编写代码**

*   首先，我们有意创建一个新的`if`语句，以确保我们的前两个测试会影响新的解决方案
*   其次，我们从条目字符串创建一个新数组，使用`,`作为分隔符
*   最后，我们解析新创建的数组的每个元素来计算总和

以下是最终代码:

**3。重构代码**

正如我们在上面看到的，我们的代码中有几个问题:

*   两个 if 语句不应该去相关，因为向零添加一个或多个应该是相同的。
*   分隔符值淹没在代码中。例如，如果我们想要更改为`;`分隔符，这就增加了复杂性。
*   我们代码的很大一部分位于一个`if`语句中。我们可以颠倒逻辑，从中提取我们的主要代码。

所以我们可以添加一个新的`separator`变量，它将决定分隔符的类型。我们也可以将两个`if`语句合并成一个，然后颠倒逻辑。

在进入下一个循环之前，我们现在可以再次运行我们的测试。

#### 第三循环

我们现在可以处理新分隔符的声明，避免输入负数。

1.  **编写测试**

*   第一个新测试关注默认值中的单个分隔符。
*   第二步将确保我们可以直接在输入中配置一个新的分隔符。
*   第三个将检查当一个负值作为条目传递时是否抛出了错误。

**2。编写代码**

*   首先，我们用一个`separators`数组替换`separator`字符串，在这里我们添加了`\n`值。
*   其次，我们通过正则表达式引入一个新的分隔符搜索。将被添加到前面的数组中。
*   我们现在可以连接前面的数组元素，用它们来分割字符串。
*   我们过滤得到的数组，删除所有非数字元素。
*   我们添加了一个新的数组`negatives`，它将在条目中发现负值。
*   如果`negatives`数组不为空，抛出一个错误。

以下是最终代码:

**3。重构代码**

我们现在有两个新的可能的优化:

*   我们两次使用正则表达式，并且愿意很容易地改变它。我们可以在新的`const regexp`中提取它。
*   我们计算了几次`parseInt(list[i])`，所以我们应该只存储一次值来加速`for`循环。

### 结论

我们现在可以再次运行我们的测试，以确保所有我们期望的功能仍然工作。

你现在也可以自己继续了。点击此处查看所有测试均通过的最终版形。

如果您有任何问题或意见，请随时在 Twitter 上联系我

感谢你的阅读，如果你喜欢这篇文章，请为我鼓掌。