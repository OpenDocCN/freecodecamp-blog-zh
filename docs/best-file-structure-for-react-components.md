# React 组件的最佳文件结构

> 原文：<https://www.freecodecamp.org/news/best-file-structure-for-react-components/>

为前端项目创建一个适当的、可伸缩的文件结构是一项挑战。当我们使用像 React 这样的非固执己见的工具时，我们拥有的自由伴随着大量的责任。

通常，当我们谈论文件结构时，讨论的重点是整个项目。但是同样重要(并且经常被忽视)的是如何最好地构造组件的问题。

让我告诉你我的意思。

## 组件目录中包括什么

组件是每个 React 应用程序的构建模块。因此，它们本身可以被视为小型项目。一个组件应该尽可能的独立(但不是更独立)。

典型的组件目录可能如下所示:

```
├── components
│   ├── Component
│   │   ├── SubComponent
│   │   │   ├── SubComponent.test.tsx
│   │   │   ├── index.tsx
│   │   ├──  Component.stories.tsx
│   │   ├──  Component.test.tsx
│   │   ├──  icon.svg
│   │   ├──  index.tsx
│   │   ├──  utils.ts
│   │   ├──  utils.test.ts 
```

我们来分解一下。

### 主索引文件

该文件的默认导出是组件本身。

此外，该指数还可以包括指定的出口。例如，如果我正在构建一个`Menu`组件，我希望能够像这样使用它:

```
import Menu, { MenuItem } from 'components/Menu'

const ComponentWithMenu = () => {
    return (
        <Menu>
            <MenuItem />
            <MenuItem />
        </Menu>
    )
} 
```

因此，在我的索引文件中，我需要将`Menu`导出为默认导出，同时将`MenuItem`子组件重新导出为命名导出。这样，我以后就可以从同一个地方导入两者。

显式的重新导出还有助于记录什么是公共的(以及打算由应用程序的其余部分使用)，什么是组件私有的。

> 注意:有一种观点认为，只有默认的导出应该是公共的，其余的都应该是私有的。要了解我为什么推荐一种不同的方法，请查看我关于[构建重要的 React 组件](https://blog.whereisthemouse.com/a-guide-to-building-non-trivial-react-components)的文章。

### 试验

为什么把测试放在这里，而不是放在一个单独的`tests`目录中？一个字——主机代管！

应该放在一起的文件应该放在一起。如果您想象一下编辑甚至删除组件的过程，这种方法的好处就会变得非常明显。当所有东西都在一个地方时，维护就简单多了。

此外，测试通常作为文档。因此，将它们放在我们的元件旁边非常有意义。

### 故事

Storybook 是一个非常棒的独立开发组件的工具。它允许我们真正地将我们的组件视为独立的小型项目。出于上述原因，将每个故事与其对应的组件放在一起是很重要的。

### 风格

当使用 CSS-in-JS 时，可以直接在组件文件中创建样式化组件。如果我们选择了 CSS 模块，那么样式文件应该和组件放在同一个目录中。

### 资产

图像、图标或其他特定于组件的资产应直接放在组件目录中。再一次-主机代管！

### Utils

实用程序可以包括从助手函数到定制钩子的所有东西。如果愿意的话，我们可以把它们分成不同的类别(钩子、服务等等)，但是基本原则是一样的。

我们应该确保所有的实用程序都是特定于组件的，而不是被应用程序的其他部分重用的东西。实用程序的测试放在组件目录中。

### 子组件

子组件的结构与主组件非常相似。它们通常由主组件使用。

如果您打算在整个应用程序中使用它们(如 out `MenuItem`示例)，它们应该在主索引文件中重新导出。没有主组件就不能使用子组件。

如果是这样，那么子组件本身应该成为主组件。

子组件应该有它们自己的共同定位的单元测试(当需要的时候)、风格和资产。大多数时候，故事只保留给主要部分。

## 在组件目录之外保留什么

这里有一个很好的规则:如果您想使用除了从组件索引中显式导出的内容之外的内容，这是一个明确的信号，表明这段代码应该放在其他地方。

我给你举个例子。

让我们回到我们的`Menu`组件。通常，我们认为如果用户在菜单外点击，菜单应该会关闭。为了做到这一点，我们创建了一个定制钩子`useClickOutside`并将其放在 utils 中。

过了一会儿，很明显我们需要完全相同的行为，这次是针对我们的`Dialog`组件。

我们希望重用我们的钩子，但同时，它不再是特定于组件的。我们应该把它从菜单组件中拿出来，放在更高的位置，可能在我们的通用实用程序文件夹中。

**注意事项**:只有在真正必要的时候，才应该小心地提升要重用的代码。作为开发人员，我们经常被诱惑[过早地](https://www.deconstructconf.com/2019/dan-abramov-the-wet-codebase)创建抽象，并且没有完整的上下文。这对项目未来的可维护性会产生严重的后果。

很多时候，如果一段代码做了类似(但不完全相同)的事情，最好在开始时复制一些功能，并且只有在对用例有足够信心时才创建抽象。

## 结论

组件结构对于 React 架构至关重要。出错会对项目的可伸缩性和可维护性产生长期的后果。这就是为什么必须指出我上面提出的只是一个模板。

虽然我发现这种结构适用于广泛的场景，但每个 React 应用程序都是独特的，或者至少有其特质。一个通用的指南不能代替对项目细节的批判性思考和相应的决策。

**如果你觉得这篇*文章*有用，[我们来连线](https://twitter.com/iva_kop)。要获得更多与 React 相关的深入文章，请查看我的博客。**