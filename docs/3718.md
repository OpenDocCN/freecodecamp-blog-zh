# 如何使用 dotenv 为应用程序存储安全信息

> 原文：<https://www.freecodecamp.org/news/how-to-store-secure-information-for-applications-with/>

本文是关于保存用户名和密码凭证信息，以便在本地测试环境中的第三方站点(如 mLab)上进行安全的数据库访问。这可以让你保护它们不被任何人在 github 这样的网站上看到。

安全或私有信息不应该存储在您的代码中，也不应该被推送到存储库中。这是因为它会被公开曝光，从而使您的信息处于危险之中。如果有人欺诈性地使用您的凭据，这也会使您面临失去 API 或数据库访问权限的风险。

[这篇 wiki 文章](https://forum.freecodecamp.com/t/guide-for-using-mongodb-and-deploying-to-heroku/19347/3)讨论了如何使用 export 命令保护您的凭证。为了使这些变量持久，您有两个选择。但是，这样设置的环境变量在每次 shell 重启时都会被删除，比如当您关闭计算机并重启进行新的编码会话时。

每次启动一个新的终端 shell 时，您都必须重复所有的步骤来设置环境变量。这意味着你需要将你的凭证保存在文本文件中，或者在你的第三方账户中查找它们(比如 mLab)。

每次开始一个新的会话时都这样做是很乏味的。因此，我将向您展示一种使用文本文件并导入您的凭证的方法，而不是将它们存储在代码本身中容易找到的地方。

第一种选择是使用您的 shell 配置文件，并在每次启动新终端时导出这些变量。然而，在开发新的应用程序和项目的几个星期后，您的 shell 配置文件会被一大堆您在每个会话中都不需要的变量所堵塞。您只需要当前正在使用的应用程序的凭据。

## **清理包含安全凭证的 git repo】**

如果您已经将您的存储库推送到 github，并且您的凭证存储在代码库中，简单地删除它们并再次推送是没有用的。这是因为您的凭据存储在您的历史记录中，公众也可以看到。如果是这种情况，请使用这些命令来重置您的 git 存储库并清除您的历史记录。

****首先，**** 从 github 删除你的回购。当我们准备好时，你会创建一个新的。

****其次，**** 从你的工作目录中删除你的本地 git 库。将目录切换到您的工作目录。你的。git 回购文件应该在这里。

注意:如果使用不当，使用-rf 标志可能会删除整个硬盘。我使用-i 标志，它代表交互，以确保我在正确的目录中。

在对几个文件进行排序后，我 100%确定我在正确的位置，我将取消该命令，并在没有-i 标志的情况下再次运行它。做您觉得最舒服的事情，但是建议您在运行-rm 命令之前对计算机进行完整备份(在多个位置)。

```
cd <project-name>
rm -i -rf .git
```

****第三**，**一定要更新你的。gitignore 文件来包含。env 文件以及您希望保持私有的任何其他文件夹。本地 IDE 文件，如。idea/如果使用 jetbrains 举例来说，可以在这个文件中。我的。gitignore 文件如下所示。请注意，您可以在创建文件夹或文件之前在这里添加它，而不会导致任何错误。

`.gitignore`
节点 _ 模块
。env
数据/
。想法/

****最后**** 创建一个新的资源库。现在，您可以继续创建您的。env 文件，并将您的 repo 安全地推送到 github，并确保您的凭据安全。

`git init`

## **如何在您的本地应用中使用 dotenv**

这就是节点模块 dotenv 可以提供帮助的地方。要使用 dotenv，您需要在您的应用程序代码中要求它。对其调用 config()函数，该函数从计算机上本地存储的文件中提取您的凭证。这个文件被命名为`.env`。

****第一步:**** 创建一个. env 文件，把你的变量保存在里面
`MONGOLAB_URI="mongodb://username:password@ds01316.mlab.com:1316/food"`

****第二步:**** 在你的主应用中要求 dotenv 在你的主`app.js`(或者随便你怎么命名)
`var dotenv = require('dotenv');`

****第三步:**** 调用变量上的 config 函数。(注意，这可以通过链接在一行中完成，但是我喜欢看到这作为一个单独的活动发生)。
`dotenv.config();`

****第四步:**** 通过调用您的流程变量:
`var url = process.env.MONGOLAB_URI;`来设置您的 mongodb URL

这种解决方案使您的代码没有您不希望推送到公共存储库的安全凭证，同时使每个应用程序组织得井井有条，并在开发过程中节省时间。

### ****[在 Mac OS X](http://osxdaily.com/2015/07/28/set-enviornment-variables-mac-os-x/)**的什么地方设置环境变量**

在命令行中，环境变量是为当前 shell 定义的，并被任何正在运行的命令或进程继承。他们可以从缺省的外壳、路径等等中确定任何东西。