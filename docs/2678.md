# Python 字典指南——如何在 Python 3.9 中迭代、复制和合并字典

> 原文：<https://www.freecodecamp.org/news/python-dictionary-guide/>

Python 是一种流行的数据科学语言。使用收藏是你需要掌握的最基本的技能之一。

集合是包含各种不同数据类型的多个元素的数据结构。

今天我们将详细了解字典，它是 Python 中一种特殊类型的集合。我们将介绍它们的基本功能、内部工作方式，以及最新 Python 版本的一些前沿特性。

本教程结束时，您将会知道

*   什么是字典
*   如何使用字典
*   如何迭代字典
*   如何抄写字典
*   如何在 Python 3.9 中合并字典

## Python 中的字典有哪些？

在深入了解某个事物之前，从简单而基本的定义开始总是好的。

正如我已经说过的，字典是 Python 中的一种集合。然而，与列表、元组和集合不同，你不存储单个值，而是存储所谓的*键值对*。这意味着您不用通过索引来引用您的值，而是使用一个键，它是一个惟一的标识符。

```
l1 = [10, "Hello", True, 20.23] # List
t1 = (10, "Hello", True, 20.23) # Tuple
s1 = {10, "Hello", True, 20.23} # Set

d1 = {'number': 10,
      'greeting': "Hello",
      'boolean': True,
      'float': 20.23} # Dictionary 
```

在上面的例子中，你可以看到不同之处。各个键值对用逗号分隔。每一对都以一个唯一的键开始，后跟一个冒号和各自的值。请注意，该值不必是唯一的，因为我们不使用它来访问或标识任何东西。

还要记住，我们可以为我们想要的键和值使用任何数据类型。这里我们只使用字符串作为标识符，但是我们也可以使用整数、浮点、集合甚至布尔。

但是，你要经常问问自己这有多合理。大多数情况下，字符串将是最佳选择。

## 如何在 Python 中使用字典

好了，现在我们知道了什么是字典，让我们来看看如何使用它们。

首先，我们将经历基本的操作，如访问、添加和删除值。之后，我们将探讨一些更高级、更有趣的话题。

在 Python 中，可以像访问任何其他集合中的元素一样访问字典中的元素。唯一的区别是你传递的是一个键而不是一个索引。这也适用于更改甚至追加值。

```
person = {'name': "Mike", 'age': 25, 'weight': 80.5}

print(person['name'])
person['name'] = "Bob" # Changing existing value
print(person['name'])

person['gender'] = 'm' # Creating new key-value pair
print(person['gender']) 
```

正如您在这里看到的，您只需传递一个键来访问它所引用的值。首先你打印名字，然后你改变它。然后再打印一次，以确保所做的更改。

请注意，这不仅适用于现有的配对，也适用于新的配对。为了创建一个新的键-值对，只需引用一个尚不存在的键并为其赋值。然后，该对被自动添加到词典中。

从字典中删除值的工作方式不同。这里你可以使用 **del** 关键字或者 **pop()** 方法。

这两种方法的主要区别在于， **del** 只移除键-值对，而 **pop()** 之后也会返回移除的值。根据您的用例，您必须决定哪种方法更适合您的任务。

## 如何在 Python 中迭代字典

因为字典是集合，所以您也可以迭代它们。但是这不像其他集合类型那样简单明了。

这是因为你处理的不是单个的值，而是成对的值。当你使用 for 循环迭代一个字典时，你实际上只是在迭代键。

```
names_ages = {'Bob': 50,
              'Anna': 28,
              'Max': 30,
              'John': 76}

for element in names_ages:
    print(element)

# Output: Bob  Anna  Max  John 
```

因此，如果您想要迭代这些值，甚至是整个对，您需要使用额外的方法。

为了访问这些值，您只需调用 **values()** 方法。它返回字典中所有值的迭代器。

要访问完整的对，可以调用 **items()** 方法。这里迭代一个元组列表，每个元组代表一个键值对。

当然还有 **keys()** 方法，以防您想在 for 循环之外使用字典键。

```
print(list(names_ages.keys()))
print(list(names_ages.values()))
print(list(names_ages.items()))

# Output
# > ['Bob', 'Anna', 'Max', 'John']
# > [50, 28, 30, 76]
# > [('Bob', 50), ('Anna', 28), ('Max', 30), ('John', 76)] 
```

这里需要记住的一件重要事情是，这些方法并不返回实际的列表。它们返回对象，您可以使用这些对象来迭代键和值。但是您可以通过使用 **list()** 函数轻松地将这些对象类型化到列表中。

## 如何用 Python 复制字典

现在我们开始进入一些更高级的东西。

你不会相信有多少次新的没有经验的程序员因为以错误的方式复制集合而陷入困境。他们花了几个小时对他们的项目进行故障诊断，却无法找到问题所在。

所以，如果你不想自己经历那种挫败感，请注意这里。

在我们讨论复制集合和字典之前，让我们看看如何复制像整数这样的原始数据类型。

```
i1 = 20
i2 = i1

i2 += 10
print(i1, i2)

# Output: 20  30 
```

当你想创建一个新的变量并把另一个整数的值复制到其中时，你只需要直接给这个变量赋值。然后，您可以更改第二个整数的值并使用它，而不更改第一个整数的任何内容。

这也适用于布尔值、浮点数、字符串等。然而，让我们看看，当我们用字典做这件事时，会发生什么。

```
d1 = {'a': 10, 'b': 20, 'c': 30}
d2 = d1
d2['c'] = 50

print(d1)
print(d2)

# Output
# {'a': 10, 'b': 20, 'c': 50}
# {'a': 10, 'b': 20, 'c': 50} 
```

这里发生了什么？我们不是做了和以前一样的事情吗？当我们修改第二本词典时，为什么第一本词典会发生变化？不就是一份复印件吗？

答案显然是否定的。当你将一个字典赋给一个新变量时，你实际上是在传递一个所谓的*引用*。

第二个变量实际上不是一个字典，而只是另一个变量，它指向与第一个变量相同的字典。因此，对哪个变量应用更改并不重要，因为它们都是在它们都引用的同一个字典上执行的。

如果想用 Python 创建一个字典的实际浅层副本，需要使用 **dict()** 函数或者调用字典的 **copy()** 方法。通过这样做，您创建了一个新的字典，它具有与原始字典相同的元素。

```
d1 = {'a': 10, 'b': 20, 'c': 30}
d2 = dict(d1)
d3 = d1.copy()

d2['b'] = 50
d3['a'] = -90
print(d1) # unchanged 
```

但是，请注意，副本中的对象仍然与第一个字典中的对象完全相同。因此，如果它们是更复杂的对象或集合，您将最终得到一个新的单独的字典(但是其中的对象将引用与第一个字典中的对象相同的对象)。

为了改变这一点，您必须进行所谓的深层复制，但这不在本文的讨论范围之内。

## 如何在 Python 中合并字典

最后，我们来谈谈 Python 3.9 最前沿的字典特性。这些功能集中在合并字典上。

直到最近，程序员不得不要么使用 **update()** 方法，要么使用解包操作符。

```
d1 = {'a': 10, 'b': 20, 'c': 30}
d2 = {'c': 40, 'd': 60, 'e': 20}
d1.update(d2)
print(d1)

d1 = {'a': 10, 'b': 20, 'c': 30}
d3 = {**d1, **d2}
print(d3) 
```

这两种方法的主要区别在于， **update()** 方法将一个字典的值添加到另一个字典中，并直接应用更改。结果字典不会返回，而是实际保存到第一个对象中。

另一方面，当您使用解包操作符时，您创建了一个新字典，并通过解包将两个字典的键-值对放入其中。

现在，您可能会问自己，当您合并两个具有相同关键字的字典时会发生什么。

您可以这样想:第一个字典创建键值对，第二个字典覆盖它。因此，如果您对第一个集合调用 update 方法，并将第二个集合作为参数传递，那么第二个字典的键值对将出现在结果中。

开箱也是一样。你最后传递的词典会覆盖前面的。

所以这是老办法。然而，在 Python 3.9 中，引入了合并和更新操作符。它们使连接字典变得更简单。

```
d1 = {'a': 10, 'b': 20, 'c': 30}
d2 = {'c': 40, 'd': 60, 'e': 20}

d3 = d1 | d2  # Merging
d1 |= d2      # Updating 
```

如您所见，用于合并的操作符与用于按位“或”操作的操作符相同。如果两个字典中有相同的键，字典的顺序很重要。右边的集合会覆盖左边的集合。

如果您想更新第一个字典而不是返回一个新字典，只需将合并操作符与基本赋值操作符结合起来。从 Python 3.9 开始，这种合并字典的方式就是推荐的方法。

如果你更多的是视觉或听觉学习者，你可以看下面我关于合并词典的视频教程。

[https://www.youtube.com/embed/RWqPfsFK1eo?feature=oembed](https://www.youtube.com/embed/RWqPfsFK1eo?feature=oembed)

## 包扎

好了，现在你应该可以很轻松地使用字典了。你不仅知道它们是什么以及如何使用它们，而且你还知道它们在更深层次上是如何工作的。

当你在做一个项目时，你会知道如何以正确的方式复制字典。我们甚至讨论了最新 Python 版本的一个前沿特性。

请确保您再次浏览代码片段，并理解它们是如何工作的以及为什么工作。这将使你成为一名更好的 Python 程序员。

如果你对更多类似的内容感兴趣，你可以看看我的 YouTube 频道 [NeuralNine](https://www.youtube.com/c/NeuralNine/) 或者我的网站【neuralnine.com T3。

对于 Python 爱好者，我有一个专门的 Python 书籍系列，从零开始教你这门语言，也深入到更高级的主题，如机器学习和计算机视觉。这里可以找到[。](https://www.neuralnine.com/books)

我希望你喜欢这篇文章，祝你有美好的一天！:)