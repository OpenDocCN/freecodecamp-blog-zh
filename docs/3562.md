# 管理混乱的开源存储库的命令行技巧

> 原文：<https://www.freecodecamp.org/news/command-line-tricks-for-managing-your-messy-open-source-repository/>

有效的协作，尤其是在开源软件开发中，始于有效的组织。为了确保不遗漏任何东西，一般规则“一个问题，一个拉取请求”是一个很好的经验法则。

与其打开一个大范围的问题，比如“修复文档中所有断开的链接”，开源项目更有可能通过几个更小、更易管理的问题吸引贡献者。

在前面的示例中，您可以按节或按页确定断开链接的范围。这允许更多的贡献者投入他们的时间，而不是等待一个人承担更大更乏味的贡献工作。

较小范围的问题也有助于项目维护人员看到哪里的工作已经完成，哪里还没有完成。这减少了问题的某些部分被遗漏、被认为已经完成，并在以后导致错误或安全漏洞的机会。

这很好。但是，如果您已经打开了几个大范围的问题，一些 pr 已经提交或合并，而您目前不知道工作从哪里开始或停止，该怎么办？

要想让你的项目回到可控状态，需要做一些整理工作。幸运的是，有许多命令行工具可以帮助您扫描、排序和理解混乱的存储库。这里是我使用的一个小选择。

## 使用`vim`进行交互式搜索和替换

您可以在 Vim 中打开一个文件，然后交互搜索并替换为:

```
:%s/\<word\>/newword/gc 
```

`%`表示在当前文件的所有行中查找，`s`表示替换，`\<word\>`表示匹配整个单词，`g`表示“全局”表示每次出现。最后的`c`可以让你在修改前查看和确认每个修改。没有`c`，你可以自动运行它，而且速度更快，但是如果你犯了一个模式匹配错误，你就把事情复杂化了。

## 用节点模块查找降价文件中的死链接

[markdown-link-check](https://github.com/tcort/markdown-link-check) 节点模块有一个很棒的 [CLI 伙伴](https://github.com/tcort/markdown-link-check#command-line-tool)。

我经常使用它，以至于把它变成了一个 [Bash 别名函数](https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/#bash-functions)。为此，请将其添加到您的`.bashrc`:

```
# Markdown link check in a folder, recursive
function mlc () {
    find $1 -name \*.md -exec markdown-link-check -p {} \;
} 
```

然后用`mlc <filename>`跑。

## 用`find`列出有或没有 git 存储库的子目录

打印作为 git 存储库的所有子目录，或者换句话说，其中有一个`.git`:

```
find . -maxdepth 1 -type d -exec test -e '{}/.git' ';' -printf "is git repo: %p\n" 
```

要打印所有不是 git 存储库的子目录，用`!`否定测试:

```
find . -maxdepth 1 -type d -exec test '!' -e '{}/.git' ';' -printf "not git repo: %p\n" 
```

## 用`xargs`从列表中提取多个 git 库

我最初用它作为用 Bash 脚本自动重新创建我的笔记本电脑的一部分，但是当你使用云实例或 docker 文件时，它非常方便。

给定一个文件，`repos.txt`每行有一个存储库的 SSH 链接(并且设置了 SSH 密钥)，运行:

```
xargs -n1 git clone < repos.txt 
```

如果您想要拉和推许多存储库，我以前写过关于如何使用 Bash 一行程序来管理您的存储库的文章。

## 用`jot`按编号列出问题

我是 OWASP Web 安全测试指南库的合著者和维护者，我最近在那里接受了一个大问题(是的，它是“修复文档中所有损坏的链接”——你怎么猜到的？)并把它分成几个更小、更易管理的问题。整整 37 个更小、更易管理的问题。

我想列举原始问题的所有问题，但是打出 37 个问题号(#275 到#312)的想法似乎非常乏味和耗时。因此，按照自然程序员的方式，我花了与输入所有这些数字相同的时间，设计了一种自动化的方法。

`jot`实用程序(`apt install athena-jot`)是一个很小的工具，当你想打印出一些数字时，它是个很大的帮助。只要告诉它你想要多少，以及从哪里开始和停止。

```
# jot [ reps [ begin [ end ] ] ]
jot 37 275 312 
```

这将在新的一行中打印从 275 到 312 的每个数字。为了使这些成为 GitHub 和许多其他平台自动识别的问题编号符号并转化为链接，您可以通过管道将输出传递给`awk`。

```
jot 37 275 312 | awk '{printf "#"$0", "}'

#275, #276, #277, #278, #279, #280, #281, #282, #283, #284, #285, #286, #287, #288, #289, #290, #291, #292, #293, #295, #296, #297, #298, #299, #300, #301, #302, #303, #304, #305, #306, #307, #308, #309, #310, #311, #312 
```

您还可以使用`jot`来生成随机或冗余数据，主要用于开发或测试目的。

## CLI 支持的开源组织

一个组织良好的开源存储库是一个维护良好的开源项目。保存这篇文章作为方便的参考，好好使用你新发现的 CLI 超能力！？