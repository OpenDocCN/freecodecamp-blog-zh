# 将生产节点/Express Mongo 应用程序部署到 AWS——反思

> 原文：<https://www.freecodecamp.org/news/deploying-a-production-node-express-mongo-app-to-aws-a-reflection-8982894289c6/>

#### 在 AWS 中部署生产 web 应用程序的经验教训

### 背景

这不是一个基于代码的教程。它包含了我希望在开始项目之前就知道的所有事情，以及我采取的非常有效的步骤。它遵循使用 Express framework 创建的 production Node.js web 应用程序的开发，该应用程序被部署到 Amazon Web Services (AWS)上。

全面的教程可在[这里](https://medium.freecodecamp.org/how-to-deploy-a-node-js-app-to-the-aws-elastic-beanstalk-f150899ed977)获得。

# 制定计划至关重要

有整本书都是关于发展计划的，所以我不打算在这里详述。喝一杯吧，不管是什么。

# 你从来没有给自己分配足够的时间

一项任务是简单还是复杂似乎并不重要。我从来没有正确估计过给定任务需要的时间。我想，随着我做的越来越多，我会越来越好地估计时间框架。

对此有所帮助的是设定一个现实的时间表，给自己足够的缓冲，以便在必要时进行调整。

# 从一开始就部署到服务器

有一句古老的 dev 谚语是这样说的，“总是在与您的部署环境相同的环境中开发。”这就是像虚拟环境这样的东西存在的原因。这是明智的建议。

现在，很容易找到一个生成器(比如 [express generator](https://www.npmjs.com/package/express-generator) 或 [create-react-app](https://www.npmjs.com/package/create-react-app) )，`yarn install`并在本地编写我们所有的代码。这对于开发来说是很棒的，但是我从上一个项目中学到的是，如果你等到最后才部署，你会惊讶于“应该工作”却没有工作的东西的数量。

对于这个项目，我选择在构建应用程序时增量部署它。它确保了我所构建的东西能够在我将要部署它的环境中工作。此外，当实际部署时间到来时，它节省了大量时间。

# 与客户沟通是关键

我的大部分工作都是自己完成的，所以有时我发现我想出的解决方案对将要使用它的人来说并不总是有意义的。获得客户的认可非常重要。事实上，如果你能设法让他们想出这个主意，他们就会 ****爱上**** 它，我保证。没有什么比被倾听更让人开心的了。

## 除此之外，我很幸运有一个非常好的客户

这与其说是一个教训，不如说是提醒你选择客户有多重要。我知道这听起来不可能，坦白地说，当你刚开始工作时，很难对自己的工作挑剔。然而，在那之前我已经接受了变成噩梦的工作，因为我忽略了那些迹象。

像“我们尽快需要它”这样的短语是一个很好的迹象，表明客户会低估你的价值。

# 为失败做准备

![1*CY8CSJcXBrmMZjuZ0SKU7w](img/3e47fb8f166583adf10153d1bc53ac64.png)

Bugs are Inevitable

我认为，有时我们会看看脸书或 Instagram 等成熟的应用程序，并试图通过我们的 1.0 版本应用程序来实现这一目标。这是不可能的，原因有二:

1.  一个应用的适当增长需要用户的投入。你认为 Instagram 有计划在他们的 1.0 版本中添加故事吗？当然不是，他们等待 Snapchat 先做，然后复制他们。？
2.  如果你一直等到完美，那就永远不会完成。

我的意思是，尽你所能，但不要执着于编写完美的函数。让它发挥作用，并不断改进。

此外，知道事情会失败，确保你正在正确地处理你的错误。用户需要知道是否出了问题，即使他们对此无能为力。

# 用户测试的重要性

如果你打算马上离开你的电脑，一定要 ****而不是**** 给客户发送一个链接，告诉他们“去看看这个”。我犯了这样的错误，然后在一个小时内，当我试图吃午饭时，收到了大量的信息。当然，除非你喜欢寿司里有虫子。并非总能解决问题。

这对你来说可能是显而易见的，但这并不意味着对其他任何人来说都是显而易见的。很多变成 bug 的小东西都是因为糟糕的 UX 或者 UI。我理所当然地认为我确切地知道需要发生什么，因为我写了这个东西。我并不是说你可以计划所有的事情，但是要知道你需要调整一些布局，这样每个人都会知道你想让他们做什么。

我最初只分配了两周时间进行 beta 测试。一个测试，一个修复。这时间不够。我结束了一周的第一部分测试，一周的清理，然后又一周的测试，接着又一周的清理。

# 不要对产品产生依赖

这个理想是由我的平面设计背景驱动的。如果我们坚持一个设计是因为我们真的喜欢它，我们会忽略所有用户的反馈(真正重要的)，永远不会改变。构建一个 app 也是一样的道理。

顾名思义，无中生有是一种创造性的行为。关于你认为用户将如何与你正在构建的东西交互，你正在做很多决定。不要认为你比用户更了解——你不了解。

# 玩得开心

你没有理由不能享受你正在做的事情。这并不是说它不会令人难以置信地令人沮丧，而是尽你所能去享受它。

# 学点东西

截止日期就是截止日期，但是如果你能把一件新的事情放进你的堆栈，那就去做吧。之后你会成为一个更好的开发者。

我在这个项目中最大的挑战是 AWS。我花了很多时间来了解 AWS。但是现在我已经为下一份工作做好了准备。将它部署到 Heroku 并收工本来是很容易的，但由于多种原因，这并不是最好的选择。

# 争取 MVP

在撰写本文时，我仍然有大约 20 个关于这个项目的未决问题。期望完成 1.0 版本的每一个项目是不现实的。最初，总是推动最小可行产品(MVP)。优先级是决定项目中真正重要的事情的关键。

****例如:**** 我的一个未决问题是，导航上的填充不正确。这是一个突发事件吗？没有。它能等到所有的核心功能都完成后再修复吗？是的。

所以，我还没修好。然而，我已经向客户表达了这一点，他们同意了。

# 下次我会做不同的事情

## 单元测试

在这个项目之前，我没有做过任何测试，所以我没有为这个项目做单元测试。大错特错。在我已经构建好东西之后，我不得不结束集成测试。

单元测试有助于以下方面:

1.  每次我添加一个新功能或改变一些东西，我都必须手动测试所有的**。不太好。**
2.  **它保持了一定水平的功能，也允许您认识到代码的一些缺点。故意编写会失败的测试有助于解决代码中的身份问题。**

**强烈推荐 [FunFunFunction](https://www.youtube.com/watch?v=Eu35xM76kKY) 的 TDD 课程开始。**

******小的先不说:**** 如果使用 express 生成器，它不导出服务器。**

**如果要用 Mocha 测试服务器，就得在`bin/www`文件末尾导出，file.module.exports = server**

## **从一开始就更深入地了解每个特性**

**当我开始的时候，我列出了所有的特性，但是我并没有深入研究如何实现它们。如果我这样做了，我可能会更好地估计我的时间。**

# **我学到的一些小事**

## **你可以通过 HTML 输入访问摄像头——欢迎来到 2018 年**

**然而，这在 iOS 中的非安全页面上不起作用。**

## **文件上传和调整大小是一件痛苦的事情**

**我经历的教程显示了本地保存的方法，但是我想利用 AWS S3。老实说，我设置的方法并不理想，所以希望我能在未来更好地解决这个问题。**

## **如果您是新帐户，AWS 不会让您创建 SSL 证书**

**事实证明，AWS 对新账户相当挑剔。客服代表说这是为了防止新账户产生巨额账单，我想这是有道理的。无论哪种方式，当你试图启动一个应用程序，而你又不能得到你的 SSL 证书排序时，这都是非常恼人的。**

******边注:**** 如果使用 AWS 进行托管，他们的证书管理器就出奇的容易。**

## **Mongo 数据库托管**

**我选择 [mLab](http://mlab.com/) 来托管我的 mongo 数据库有几个原因:**

1.  **我想要备份，而不需要处理备份。mLab 为你做那件事。**
2.  **我不想花太多钱(或者说，我不想让我的客户花太多钱)。每千兆字节的价格是 10 美元。**
3.  **此外，它们允许在 AWS 上托管。所以在我看来会更快。我很怀疑，但这想法很重要，对吧？**

## **较美丽**

**漂亮是救命恩人。但是，它经常和我的 ESLint 打架。首先，它总是去掉我在单个参数函数周围的括号。含义:`(var) => {}`**

**相对**

**`var => {}`**

## **Illustrator 不断创建 1000 x 1001 像素的图标**

**事实证明，如果你不把画板排列到像素网格上，它就会把它扔掉。使用自动排列艺术板功能可以解决这个问题。更多信息[点击这里](https://www.reddit.com/r/AdobeIllustrator/comments/3dqadd/1_pixel_off_when_exporting_artboards_to_png/)。**

# **为失败做准备很重要**

**我和使用这个应用的其他人相处得越久，我就越需要调整我的数据库和视图。这意味着打破曾经有效的东西。**

**很难计划每件事，但我养成了习惯，希望没有数据，并处理它。**

******例如:**** 我改变了存储图像的方式。那是在一个叫做“文档”的领域里。当我改变它的存储方式时，我也改变了它在视图中的位置，但是这破坏了旧的条目。**

**我通过首先检查是否有任何东西来解决这个问题。如果有，运行一些逻辑。**

# **摘要**

**这不是我学到的所有东西，但希望其中一些对某人有用。如果你有问题，打电话给我。**

**我不能分享这个项目的代码，因为它是一个客户。但是，如果您有任何问题，我很乐意详细阐述本文中的任何内容。**

******快乐编码** g！****