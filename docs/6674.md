# 特定问题的通用解决方案:何时写代码，何时直接写

> 原文：<https://www.freecodecamp.org/news/generic-solutions-to-specific-problems-2562fbd37a5a/>

作者:Rina Artstain

# 特定问题的通用解决方案:何时写代码，何时直接写

![1*0BIInBkbvWUbf2j1krD2Iw](img/e9e9cc25be8420fec7a069fc0f2b7f3c.png)

Photo by [Oliver Roos](https://unsplash.com/photos/PCNdauVPbjA?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/fork?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

有一个传统的故事，讲的是一个拉比遇到一个坐在岔路口的人。拉比问这个人哪条路去城里最好，这个人回答说:一条是很长的短路，另一条是很短的长路。拉比选择了捷径，但很快就到达了一个布满荆棘的田野，他无法通过，必须回头走另一条路，这条路实际上把他带到了城市。

这个故事的寓意，除了想知道这个人是不是历史上的第一个巨魔，是有时试图走捷径会比走远路更长。

### 长路编码(短路)

如果你专门为内部或外部使用编写一个 API 或库，你知道它应该尽可能的通用。你希望它清晰、简洁、易用，同时给你的用户很大的灵活性。这些目标之间有权衡，但你会弄清楚的。

但是，当你被赋予一个特定的任务去完成，你要么就去做，要么就写一些基础设施，让将来做起来更容易，会发生什么呢？

你应该尽快完成任务，还是花时间建立一些基础设施，使未来的任务更容易完成？

你应该选择一条可能会变得漫长的捷径，还是一条实际上会帮助你更快达到目标的长路？

### 一个例子(基于真实故事)

(为了简单和更好地讲述故事，一些细节被改变或省略了。现实太混乱了。)

一天，我的老板找到我，让我迅速从数据库中获取一些数据，并以 excel 表格的形式发送给他。这不是太复杂，所以我马上就做了。

第二天，他再次要求相同的数据，但日期不同。他想了一会儿，说,——也许你应该把这份报告放到网上。我希望能够随时访问这些数据，并自己选择日期。

没问题！开始吧，一些前端，一些后端，部署。等等。等等。等等。部署完成，报告在线。

过了几天，我被要求做另一份快速报告，“用你上次给我们的那个漂亮的界面和日期过滤器做吧”。好的，当然。没问题。前端、后端、部署、等待、在线。

下一次我收到类似的请求时，我说:“看，写这个报告要花我半天时间，但是如果你给我两天时间，我可以建立一些基础设施，允许我在数据库中定义一个查询，添加一些配置，然后你的报告就可以运行了，而不必等待部署”。我的请求被批准了。

#### 下面是我这两天做的事情:

我为“report”存储过程定义了一个约定，该存储过程期望获得以下参数:

*   开始日期
*   至今
*   从索引开始(用于分页)

每个过程返回一个查询结果集和总结果计数(用于分页)。

此外，我添加了一个报告表，其中包含:

*   存储过程名称(要执行)
*   (报告的)标题
*   描述(将显示在报告页面上)

我还在服务器上添加了一个端点、UI 和一些逻辑来:

*   检查数据库中的报告，并将它们添加到站点导航中。
*   当访问报表时，执行匹配的存储过程并将结果返回给 UI。
*   显示两个日期选择器，用于选择起始日期和结束日期并执行查询。
*   根据每列的数据类型显示格式化结果的通用表。(我已经有了一个通用的分页 UI 组件，耶！)

完成后，我可以在数据库中添加一个存储过程和一个条目，报告就会自动出现在我们的站点上。

### 唯一不变的是变化

每个人都对我节省时间的报告功能感到非常高兴和兴奋，但是…排序呢？我们可以将第一列链接到客户的个人资料吗？我们是否可以添加负责该客户的销售代表的过滤功能？

耶！当然可以。这很有道理。所以我补充道:

*   存储过程的可选排序依据和排序方向参数。
*   用于指定第一列是否应链接到客户配置文件的标志。
*   用于指定查询是否包括按销售代表筛选的另一个标志。
*   以及一些支持显示/执行这些新需求的 UI/逻辑更改。

快乐快乐，快乐快乐。但是…把结果分组怎么样？当您单击该行时，是否可以向一组预定义的用户发送电子邮件？当销售代表输入报告时，您能让报告以他们喜欢的颜色显示吗？(好吧，最后一个是我编的)

#### 别着急

在这一点上，我不得不停下来思考哪些特性应该作为我的通用解决方案的一部分来实现，哪些应该作为独立的解决方案来开发。

对我来说很明显，不依赖于查询返回的实际数据的特定自定义操作(比如向某些预定义的用户发送电子邮件)是不可能的。

我还认为，依赖于查询返回的数据的不常见操作不应该添加到通用报告基础结构中。所以，按销售代表筛选—当然，为什么不呢。链接到客户—好的，常见场景。但是其他特定于单个报告的操作—没有。

分组需求提出了更多的挑战:分组是一种常见且极其有用的场景。我是否应该将其添加到我的基础架构中？

那么，对结果进行分组需要什么？

*   将 Group By 标志添加到报告的 DB 条目中，让逻辑知道预期有两个不同的结果集—组头和组细节。
*   逻辑还必须知道如何将组与细节相匹配，并且必须按照惯例来完成。风险极高的生意。
*   弄清楚如何使用组标题对结果进行一般排序。我甚至不能。
*   可能还有一些我没有想到的问题。

### 没有写的代码

我没有加分组。

回想起来，在这个报告特性上总共投入了大约一周的时间，为我后来开发报告节省了数百个小时。我还设法避免了试图过于一般化和支持过多无关的**东西、**的陷阱，这从长远来看会损害系统的稳定性。

但是真的，我不应该写一行代码。我应该找一个报告工具。

然而，还有其他我写的通用助手系统，它们是很好的投资，而且**应该已经写好了。例如，一个帮助器库，它创建具有可预测的 id 的 HTML 元素和为我们的数据模型和 UI 需求定制的类。**

### 现在怎么办？

那么你应该如何决定是写一些基础设施还是只做呢？我是这样决定的:

*   是死记硬背的任务吗？如果它很无聊且反复出现，如果你发现自己经常复制粘贴大量代码——检查一下你是否能概括你正在做的事情，并为你构建一些代码。
*   建设基础设施需要多长时间？如果你能在 5 分钟内构建好基础设施，而每项任务要花你 5 天时间，那么这个问题很容易回答。如果构建基础设施需要一年时间，而每项任务只需要 5 分钟，那就不要构建它。但通常不是那么明确。尽你所能去估算，尽量保持简单，如果花费的时间太长，准备好减少你的损失。
*   不要将特定的实现添加到通用解决方案中。如果不合适，就不要勉强。您将最终毁坏您的基础设施，并且对于您实际尝试完成的任务得到一个平庸的结果。
*   但是首先，**请**检查是否有现成的解决方案。

喜欢你读的吗？鼓掌分享爱。有问题或意见吗？请在评论区告诉我。