# 向 AirBnB 的 JavaScript 风格指南呼吸空气

> 原文：<https://www.freecodecamp.org/news/adding-some-air-to-the-airbnb-style-guide-3df40e31c57a/>

没有人打算写难看的、风格不一致的代码。它就这样发生了。

即使作为一个项目的唯一开发人员，时间过得越久，编写的代码越多，保持一致的代码风格就越难。

这就是为什么你需要一个风格指南。

我亲身经历了在采用风格指南后，团队可以完成多少工作。

你不再需要整天做一些小的风格判断。查阅风格指南就可以了。

当一个团队成员需要维护你的代码时，这是他们可以阅读和理解的干净的代码。

采用风格指南是提高代码可维护性的最简单的方法之一——最终提高团队的生产力。所以让我们来探索一下最流行的方法。

#### 输入 Airbnb+line

JavaScript 生态系统提供了各种各样的[工具](https://www.sitepoint.com/comparison-javascript-linting-tools/)和[风格指南](http://noeticforce.com/best-javascript-style-guide-for-maintainable-code)。这应该不会让任何人感到惊讶。有了 JavaScript，我们开始期待各种各样的东西。

但是随着生态系统的成熟，有经验的开发人员开始渴望“标准的方式”来做事情，这是更加固化的生态系统所提供的。

当然，我们欢迎你花几天时间探索 JavaScript 生态系统并比较不同的工具，但我会尽量为你节省一些时间 **: [ESLint](http://eslint.org/) 是最受欢迎的 JavaScript 林挺工具， [AirBnB 的风格指南](https://github.com/airbnb/javascript)是使用最广泛的风格指南。**

有关将 ESLint 添加到项目签出的更多详细信息，请点击此链接。

一旦你做好准备，你就可以通过安装他们的 npm 包来配置你的项目，以执行 AirBnB 的风格指南:

```
npm install --save-dev eslint-config-airbnb
```

在您的*中添加下面一行。eslintrc* 文件

```
"extends": "airbnb"
```

瞧！您的代码现在遵循最流行的 JavaScript 风格指南的规则。编码快乐！

#### 标准被高估了

虽然我同意风格指南中的大多数规则，但这里有一个我编译的覆盖列表。这是什么*。项目根文件夹中的 eslintrc* 文件如下所示:

让我详细解释一下这些定制背后的原因。

#### 刻痕

制表符对空格的战争可能会破坏友谊，甚至可能破坏浪漫的关系。

我更喜欢我的代码缩进 4 个空格，尽管绝大多数配置更喜欢缩进 2 个空格。

我的理由是，为了编写干净的代码，更大的缩进可以让你更好地直观地了解函数中嵌套的深度，以及你有多少不同的分支。

你绝对不应该在一个 JavaScript 文件中嵌套超过 3 或 4 层的代码(这是一种代码味道)。因此，4 个空格为您提供了更好的可读性，同时保留了其他规则，比如将您的代码保持在每行 80 或 120 个字符的限制内。

此外，缩进是为 AirBnB 的默认风格指南注入更多“空气”的规则之一。因此，你的代码不会拥挤在编辑器的左侧。

#### 间隔

这大概是最大的偏离标准了。我讨厌拥挤的代码。两年多前，我开始用额外的空格填充来编写代码，并且从未回头。

那么这些规则意味着什么呢？好吧，看看下面的代码。它在技术上尊重 AirBnB 官方风格指南的规则。

我知道，这有点令人困惑。我试图从我的一个代码库中寻找一个中等复杂度的函数，但我不得不混淆其中的许多内容，所以不要试图理解代码背后的逻辑(因为根本没有)。试着去读吧。例如，当参数被传递给函数时，以及函数调用在哪里时，试着关注在多个地方使用的变量。

现在看看相同的代码，但是应用了额外的间距规则:

我并不是说现在它的可读性很高，但是您可以更容易地确定在哪里向函数发送了参数——尤其是在 curried 函数周围。

还要检查两个示例中 2 倍和 4 倍空格缩进的区别。

起初，这些技术可能看起来不是一个很大的改进。我鼓励你试一试。我想你会很快体会到这有多么不同。

#### 引用战争

虽然前两个类别有一些明确的论点，但我必须说,**单引号**对**双引号**的决定是一个高度主观的决定。

我对双引号的偏好可能是因为我经常使用 React，在 React 中，你将 JavaScript 与 [JSX 标签](https://facebook.github.io/react/docs/jsx-in-depth.html)混合在一起。因为 JSX 更接近 HTML，所以倾向于在双引号之间添加属性。所以我开始对所有东西都用双引号，只是为了保持一致。

我注意到的一件事是，你更可能需要在一串英文文本中写单引号，而不是双引号(“我在这里”、“不要这样”)。所以在这些情况下，双引号可能更方便。

#### 代码排列

AirBnB 的官方风格指南有一个“定义前不使用”的规则，如果你试图在定义前使用某个东西，就会抛出一个错误。这是一个很好的规则——特别是对于变量——因为你不应该依赖提升，而且当你使用 let 和 const 时，你应该记住[时间死区](http://jsrocks.org/2015/01/temporal-dead-zone-tdz-demystified/)的问题。

我更喜欢在定义函数之前使用它们。原因很简单:大多数时候，你会将你的功能分解成更小的子功能。然而，“定义前不使用”规则会告诉你将这些子函数**放在原始函数**之前。

但是你的子函数是用来抽象部分算法的。当你打开一个包含你的顶层函数的文件时，它们不会打扰你，你在文件之外使用这个函数。

当然，这是值得商榷的。但是它确实会影响调试。当你迭代一些代码时，你发现一个不同函数的调用，理想情况下，你应该能够看到它的下面，或者——最坏的情况——向下滚动几个子函数，找到你想要的。

这一点，结合 AirBnB 的[函数*声明*反对函数*表达式*](http://eslint.org/docs/rules/func-style) 规则，可以让你自由地按照自己喜欢的方式构造你的模块或函数库，同时确保你不会意外调用未初始化的函数。

#### Const over let

这是与风格指南的另一个小偏差。您可以在我的配置中注意到:

```
"prefer-const": 1
```

在 AirBnB 配置中，这被设置为 **2，**代表*错误*，而 **1** 代表*警告*。

现在，如果你不明白为什么你应该选择 const 而不是 let，你可以在这里和这里阅读更多关于它的内容。

关于我的偏差，我更喜欢一个警告，因为有些情况下你没有改变变量的赋值，但是你改变了它的很多内容。

看看这段代码:

规则会告诉你这是正确的— *哈希*应该是*常量*，因为它没有被重新赋值。但这对我来说从来都没有意义。我应该意识到 *hash 内部正在发生巨大的变化。*

因此，我将使用 *let* 来表示变量会发生变化的事实。 *const* 和 *let* 应该赋予你的变量更多的意义，而不应该以任何方式隐藏真相。

#### 代码复杂性

你可以[圈代码复杂度](https://reactjsnews.com/composing-components)来计算你每个函数的复杂度。

决定最大复杂程度是很棘手的。理想情况下，它应该尽可能低，这意味着你的函数应该最多有 1 或 2 个分支的可能性。

从代码重用和测试的角度来看，这个数字越低越好。但是有时候更难分解功能。这就是为什么我把复杂性更多地看作是一个警告，而不是一个错误。

这里重要的是限制达到最大复杂度限制的函数数量。即使在中等规模的代码库中，我也不希望看到超过 10 个函数打破这个规则。所以我选择了最大值 5，以突出这些功能。当我有时间做一些重构时，我会针对这些函数。

复杂性可以通过多种方式解决。重构为更小的函数是显而易见的。另一个选择是将您的 *switch* 语句转换成映射赋值。

我们在团队内部进行了几次辩论，最终我们使用 5 作为最大复杂度规则的参考值。但是在某些情况下，我们会降低到 4，只是为了确保我们写的代码简洁明了。

#### 关于 React 的一个注记

因为我经常使用 React，而且 AirBnB 的配置也包含了这方面的大量规则，所以我想在这里也包含一些我的偏好。

我的 React 覆盖的主要目标是限制常规 JavaScript 模块和 React 组件之间的差异，以及 JavaScript 代码和 JSX 之间的差异。这就是为什么我对所有 JSX 属性选择相似的缩进和双引号。这就是为什么我喜欢把我所有的文件放在。js 扩展。

最后，关于[类 vs 工厂组件](https://reactjsnews.com/composing-components)，我倾向于后者。在这一点上，我看不出使用类有什么好处。我可能会在以后的文章中详述我为什么会有这种感觉。

差不多就是这样！我希望你喜欢读这篇文章。我欢迎你在下面的反馈。

如果你喜欢这篇文章，点击下面的绿色心脏，我会知道我的努力没有白费。