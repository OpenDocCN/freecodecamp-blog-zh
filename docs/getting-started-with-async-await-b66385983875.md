# 异步/等待入门

> 原文：<https://www.freecodecamp.org/news/getting-started-with-async-await-b66385983875/>

贾蒙·弗格森

# 异步/等待入门

![1*RXBeQAwHOw_tZ2oBL4h8QA](img/fee35c1cd0fdb42821277ed974091d78.png)

受 [Zeit 团队关于主题](https://zeit.co/blog/async-and-await)的帖子的启发，我在 PayPal 的团队最近将我们的主要服务器端代码库迁移到使用 Async/Await。我很高兴与你分享我们一路走来学到的一些东西。

让我们从一些术语开始:

*   **异步功能**
*   **等待关键字**

人们通常说 async/await 很可爱，但你应该知道它们不是一回事。有*异步函数* 和*等待关键字*。它们在某些方面确实是联系在一起的，但是异步函数尤其可以在没有 await 的情况下使用。这是怎么回事？

#### 异步函数返回一个承诺

当你用 async 关键字创建一个函数时，这个函数总是会返回一个承诺。当你在异步函数中返回时，它将你的值包装在一个承诺中。

即使你的代码抛出了一个异步函数，它也不会自动冒泡，相反它会返回一个被拒绝的承诺

#### 异步函数是唯一可以使用 Await 的地方

除了将您的回报转换为承诺，异步函数的特殊之处还在于它是唯一可以使用 await 关键字的地方。*

什么是 **await** 关键字？Await 允许您暂停异步函数的执行，直到它收到承诺的结果。这使您可以编写异步代码，按照代码执行的顺序读取。

Await 允许您编写完全没有回调的异步代码。这使得你的代码可读性更好。和 await 可以处理任何承诺，而不仅仅是异步函数创建的承诺。

#### 异步函数中的错误处理

因为一个异步函数是一个**承诺**，当你**将**扔进一个异步函数时，它被吞掉并作为一个拒绝的承诺返回。

如果您使用**等待**来调用**承诺**，那么您可以将它包装在**尝试/捕捉**中，或者您需要向返回的承诺添加一个**捕捉**处理程序。

承诺错误通常会浮出水面，所以你通常只需要在顶层承诺中使用 **try/catch** 。

#### 把所有的放在一起

利用 promises 的错误处理属性和异步函数的简洁语法可以产生一些非常简单的结果。

在这个简化的示例中，您可以看到如何利用异步函数固有的错误处理能力来简化 Express 应用程序中的错误处理

在我的 PayPal 团队中，我们通常用 **next(err)来处理错误。**然而，使用 async/await，我们可以简单地**在代码的任何地方抛出**错误，路由器会将它们转发给 Express **提供的**下一个**函数。这是一个巨大的简化。**

从回调到承诺和 async/await 压缩了我们应用程序中的错误处理，并将提高我们对更复杂代码路径的理解。我花了几个小时将我们的大多数路线从简单的回调迁移到这种新方法。实际上，你唯一需要开始做的事情就是对承诺的扎实知识和对 T2 如何建立巴别塔的理解。

我热切地期待听到您对这些新奇函数的体验，并且相信它们将成为我在 JavaScript 工具箱中最喜欢的工具之一。

*当前规范([中不允许顶级 await，尽管有一些关于未来可能允许这样做的讨论](https://github.com/tc39/ecmascript-asyncawait/issues/9#issuecomment-127427447))。