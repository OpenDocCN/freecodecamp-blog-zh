# Next.js 和 Firebase 教程——如何构建 Evernote 克隆

> 原文：<https://www.freecodecamp.org/news/nextjs-firebase-tutorial-build-an-evernote-clone/>

Next.js 是基于 React 的服务器端渲染框架，是搜索引擎优化的。

因此，让我们使用 Next.js 构建一个 Evernote 克隆来了解它是如何工作的。

我们将使用以下技术堆栈:

1.  UI 的 Next.js
2.  用于数据库和托管我们的应用程序的 Firebase
3.  样式表的 SASS

那么，我们开始吧。

## 如何创建下一个应用程序

就像我们用来创建 React 应用程序的命令一样，我们也有一个快速制作下一个应用程序的命令。看起来是这样的:

```
npx create-next-app@latest
# or
yarn create next-app
```

如果使用 npm，使用`npx create-next-app@latest`。或者，如果使用纱线卷装管理器，使用`yarn create next-app`。

但是首先，您需要在系统中安装 Node.js。前往[https://nodejs.org/en/download/](https://nodejs.org/en/download/)下载并安装节点。

![Screenshot-2022-01-30-185459](img/1b078ee87e914623357d33cc8369f885.png)

给项目起一个名字，在我们的例子中是 evernote-clone。

在项目创建完成后，我们将找到一个文件结构，它就是我们在 React 中看到的。

![Screenshot-2022-01-30-185727](img/2ecc0b12846cfc61d062449c3c97f52b.png)

让我们现在启动应用程序。只需键入`npm run dev`，这就是您将在终端中看到的内容:

![Screenshot-2022-01-30-185921](img/f8ff9594a51e157332a91a9119c9f6e5.png)

和 React 一样，Next 带有一些样板代码。

![Screenshot-2022-01-30-190055](img/9946ea2db149ac462393e94709070fed.png)

让我们删除所有这些代码，从头开始。

打开 pages 文件夹中的 index.js，您将看到所有这些代码:

```
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.css'

export default function Home() {
  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>
        <h1 className={styles.title}>
          Welcome to <a href="https://nextjs.org">Next.js!</a>
        </h1>

        <p className={styles.description}>
          Get started by editing{' '}
          <code className={styles.code}>pages/index.js</code>
        </p>

        <div className={styles.grid}>
          <a href="https://nextjs.org/docs" className={styles.card}>
            <h2>Documentation &rarr;</h2>
            <p>Find in-depth information about Next.js features and API.</p>
          </a>

          <a href="https://nextjs.org/learn" className={styles.card}>
            <h2>Learn &rarr;</h2>
            <p>Learn about Next.js in an interactive course with quizzes!</p>
          </a>

          <a
            href="https://github.com/vercel/next.js/tree/canary/examples"
            className={styles.card}
          >
            <h2>Examples &rarr;</h2>
            <p>Discover and deploy boilerplate example Next.js projects.</p>
          </a>

          <a
            href="https://vercel.com/new?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
            className={styles.card}
          >
            <h2>Deploy &rarr;</h2>
            <p>
              Instantly deploy your Next.js site to a public URL with Vercel.
            </p>
          </a>
        </div>
      </main>

      <footer className={styles.footer}>
        <a
          href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
          target="_blank"
          rel="noopener noreferrer"
        >
          Powered by{' '}
          <span className={styles.logo}>
            <Image src="/vercel.svg" alt="Vercel Logo" width={72} height={16} />
          </span>
        </a>
      </footer>
    </div>
  )
} 
```

把这些都清除掉，这样你就可以从头开始了。这是你现在应该有的:

```
import Head from 'next/head'
import styles from '../styles/Home.module.css'

export default function Home() {
  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>

      </main>
    </div>
  )
} 
```

这个清理过的代码包含 Title 标签和 Main 标签，我们可以在这里编写代码。

```
import Head from 'next/head'
import styles from '../styles/Home.module.css'

export default function Home() {
  return (
    <div className={styles.container}>
      <Head>
        <title>Evernote Clone</title>
        <meta name="description" content="This is an Evernote Clone" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main className={styles.main}>

      </main>
    </div>
  )
} 
```

我们所有的样式都在`Home.module.css`中，这就是我们创建样式表的方式。

## 如何安装 SASS、Firebase 和 React Quill

让我们现在安装 SASS 和 Firebase。

```
npm i firebase sass react-quill
```

使用上面的命令一次安装所有的软件。

让我解释一下我们将如何使用这些工具:

1.  firebase——在后端存储我们的 Notes 数据
2.  SASS——我们用 SASS 代替 CSS，因为它提供了很多 CSS 中没有的不同特性。
3.  react Quill——注释的富文本区域编辑器。

现在，在你安装好这些之后，让我们继续。

我们需要把我们的屏幕分成两部分。左边部分将包含创建新笔记的选项，而右边将显示它们。

在 main 中创建一个 div，它将包含另外两个 div。每个 div 都指向样式表中各自的类。

```
<main className={styles.main}>
        <div className={styles.container}>
          <div className={styles.left}>Left</div>
          <div className={styles.right}>Right</div>
        </div>
      </main>
```

现在，让我们创建一个样式表文件。将其命名为 Evernote.modules.scss。

![Screenshot-2022-01-30-191605](img/ad26f4789612084774a7173efe2a73e6.png)

这是我们将要进行造型的文件。

现在让我们把容器安排成 flex。

```
.container {
    display: flex;
    margin: 10px;
}

.left{
    width: 20rem;
}
```

我们在容器中显示 flex，左侧容器的宽度为 20 rem。这会产生以下输出:

![Screenshot-2022-01-30-192230](img/652b6384245400595c417b479730f332.png)

现在，在 pages 中创建一个名为 components 的文件夹。它将包含我们所有的微型组件。

在 components 文件夹中，创建一个名为 NoteOperations.js 的文件。

然后，在主 index.js 文件中导入这个组件，并在主。

```
import NoteOperations from './components/NoteOperations';

<main>
        <div className={styles.container}>
          <div className={styles.left}>
            <NoteOperations />
          </div>
          <div className={styles.right}>Right</div>
        </div>
      </main>
```

但是您会马上看到一个错误，因为我们在 NoteOperations 组件中没有任何东西。

![Screenshot-2022-01-30-192735](img/359cfd0fc5451ade3733aef792afffdb.png)

让我们创建一个 NoteOperation.js 功能组件。

```
export default function NoteOperations() {
    return (
        <>
        </>
    )
}
```

它现在正在返回一个空的片段。因此，让我们创建一个添加新注释的按钮。

```
import styles from '../../styles/Evernote.module.scss'

export default function NoteOperations() {
    return (
        <>
            <div className={styles.btnContainer}>
                <button
                    className={styles.button}>
                    Add a New Note
                </button>
            </div>
        </>
    )
}
```

![Screenshot-2022-01-30-193707](img/8f48938da8dbe8f6a2a3240b0f417dda.png)

这将是我们目前的输出。让我们把我们的按钮设计得好看一点。

```
.button {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: black;
    color: whitesmoke;
    border: black;
}
```

这些样式将导致以下按钮设计:

![Screenshot-2022-01-30-194323](img/96d64dbd343e7adb3817189d90433622.png)

让我们从谷歌字体中导入 Roboto 字体，用于我们的笔记。

```
@import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
```

将它放在样式表文件的顶部，以便使用该字体，如下所示:

```
.button {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: black;
    color: whitesmoke;
    border: black;
    font-family: 'Roboto';
} 
```

现在你会看到按钮字体的变化。

现在，让我们添加按钮功能。当我们点击 Add a New Note 按钮时，底部会弹出一个文本输入。

首先，让我们创建文本字段:

```
import styles from '../../styles/Evernote.module.scss'

export default function NoteOperations() {
    return (
        <>
            <div className={styles.btnContainer}>
                <button
                    className={styles.button}>
                    Add a New Note
                </button>
            </div>

            <div className={styles.inputContainer}>
                <input placeholder='Enter the Title..'/>
            </div>
        </>
    )
}
```

让我们给这个输入元素添加一些样式:

```
.input{
    width: 15rem;
    height: 2rem;
    outline: none;
    border-radius: 5px;
    border: 1px solid gray;
    margin: 5px 0;
}
```

这是我们的输入现在的样子:

![Screenshot-2022-01-30-195052](img/0d9ee174d696735695e734ffbf557bcf.png)

但是只有当我们单击“添加新注释”按钮时，该按钮才会出现。因此，我们需要使用反应状态。

```
import { useState } from 'react'

const [isInputVisible, setInputVisible] = useState(false);
```

因此，我们从 React 导入了 useState 钩子，我们有了一个状态`isInputVisible`。

我们还需要一个函数，当我们单击按钮时，它将被触发。

```
import styles from '../../styles/Evernote.module.scss'
import { useState } from 'react'
export default function NoteOperations() {
    const [isInputVisible, setInputVisible] = useState(false);
    const inputToggle = () => {
        setInputVisible(!isInputVisible)
    }
    return (
        <>
            <div className={styles.btnContainer}>
                <button
                    onClick={inputToggle}
                    className={styles.button}>
                    Add a New Note
                </button>
            </div>

            <div className={styles.inputContainer}>
                <input className={styles.input} placeholder='Enter the Title..'/>
            </div>
        </>
    )
}
```

因此，当我们单击添加新注释按钮时，它将在 true 和 false 之间切换 IsInputVisible。基于这个条件，我们需要显示我们的输入元素。

```
{isInputVisible ? (
                <div className={styles.inputContainer}>
                    <input className={styles.input} placeholder='Enter the Title..' />
                </div>
            ) : (
                <></>
            )}
```

所以，我们用一个三元运算符来检查。如果 isInputVisible 状态为 true，它将显示输入字段，否则将隐藏它。

以下是到目前为止的全部代码:

```
import styles from '../../styles/Evernote.module.scss'
import { useState } from 'react'
export default function NoteOperations() {
    const [isInputVisible, setInputVisible] = useState(false);
    const inputToggle = () => {
        setInputVisible(!isInputVisible)
    }
    return (
        <>
            <div className={styles.btnContainer}>
                <button
                    onClick={inputToggle}
                    className={styles.button}>
                    Add a New Note
                </button>
            </div>

            {isInputVisible ? (
                <div className={styles.inputContainer}>
                    <input className={styles.input} placeholder='Enter the Title..' />
                </div>
            ) : (
                <></>
            )}
        </>
    )
}
```

现在，我们需要从输入字段获取数据。所以，我们还需要一个州。

让我们创建一个状态，并使用 onChange 事件将 setState 函数绑定到输入字段。这意味着无论何时我们的输入发生变化，或者当我们输入时，state 的值都会更新。

```
const [noteTitle, setNoteTitle] = useState('');

<div className={styles.inputContainer}>
                    <input 
                    className={styles.input} 
                    placeholder='Enter the Title..' 
                    onChange={(e) => setNoteTitle(e.target.value)}
                    />
                </div>
```

## 如何向 Firebase 发送数据

现在，让我们将数据发送到 Firebase Firestore。

去 https://firebase.google.com/创建一个新项目。

![Screenshot-2022-01-30-200136](img/d4f76d998f07643c8c7c9e3f740a882f.png)

它将返回我们需要添加到下一个应用程序中的所有配置数据。

如果你想了解这一切是如何运作的，我在 YouTube 上有一个完整的播放列表。[请务必在这里查看](https://www.youtube.com/playlist?list=PLWgH1O_994O8B_HVG2iuyqBEWPGa5Lhoj)。

![Screenshot-2022-01-30-200350](img/7829b46701d5ec4560a4ccfb8e8ccfee.png)

因此，在创建项目之后，我们需要创建一个应用程序。创建应用程序后，它会返回一些配置数据。

```
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyAaLhtQ-B698GWyLNihGVRaNWBOKtBH8wU",
  authDomain: "evernoteclone-7682f.firebaseapp.com",
  projectId: "evernoteclone-7682f",
  storageBucket: "evernoteclone-7682f.appspot.com",
  messagingSenderId: "332984082327",
  appId: "1:332984082327:web:ae2776c3a56f4d98816ed2"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
```

在我们的下一个应用程序中创建一个名为 firebaseConfig.js 的新文件，并将它们添加到那里。该文件将类似于以下内容:

![Screenshot-2022-01-30-200803](img/06e3c72ef96f051e3805334848ae1300.png)

因为我们将使用 Firestore 数据库，所以我们也需要导入 Firestore 函数。

![Screenshot-2022-01-30-201008](img/79e2087a7a2ee05c4dd8d4ff755d756c.png)

我们还需要出口它们。现在我们可以在应用程序中使用 Firestore 数据库了。

## 如何将我们的笔记添加到 firestorm

现在，让我们将笔记添加到 Firestore 数据库中。

在 NoteOperations.js 中，导入 firebase 配置文件。

```
import { app, database } from '../../firebaseConfig';
```

我们还需要 Firebase Firestore 的一些功能，所以让我们导入它们。

```
import { collection, addDoc } from 'firebase/firestore';
```

这里，我们将使用`collection`来创建一个集合，addDoc 会将我们的数据添加到该集合中。

所以，我们先创建一个集合。我们将这个集合命名为 dbInstance。

```
const dbInstance = collection(database, 'notes');
```

它从 firebaseConfig 导入中获取数据库和集合的名称。

让我们创建一个按钮来保存 forestse 数据库中的注释。

```
<button
   className={styles.saveBtn}>
   Save Note
</button>
```

现在我们将添加保存笔记按钮样式。

```
.saveBtn{
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: rgb(119, 27, 27);
    color: whitesmoke;
    border: rgb(119, 27, 27);
    font-family: 'Roboto';
}
```

但是等等——因为我们正在使用 SASS，我们可以为我们的颜色定义变量。

```
$dark-red: rgb(119, 27, 27);
$black: black;
$whiteSmoke: whiteSmoke;
```

现在，我们可以在任何地方使用这些颜色。

```
@import url("https://fonts.googleapis.com/css2?family=Roboto&display=swap");

$dark-red: rgb(119, 27, 27);
$black: black;
$whiteSmoke: whiteSmoke;
$gray: gray;

.container {
    display: flex;
}

.left {
    width: 20rem;
}

.button {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: $black;
    color: $whiteSmoke;
    border: $black;
    font-family: "Roboto";
}

.input {
    width: 15rem;
    height: 2rem;
    outline: none;
    border-radius: 5px;
    border: 1px solid $gray;
    margin: 5px 0;
}

.saveBtn {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: $dark-red;
    color: $whiteSmoke;
    border: $dark-red;
    font-family: "Roboto";
} 
```

这是我们现在的输出。

![Screenshot-2022-01-30-214046](img/afadce8c0a9bfe33e0bf71d27a70d3c6.png)

让我们创建一个函数，将笔记保存到 Firebase，当我们单击 Save Note 按钮时，该函数将运行。

```
const saveNote = () => {

}
```

在“保存注释”按钮中，添加以下代码:

```
<button
                        onClick={saveNote}
                        className={styles.saveBtn}>
                        Save Note
                    </button>
```

现在，在 saveNote 函数中，我们将使用 addDoc 函数。

```
const saveNote = () => {
        addDoc(dbInstance, {
            noteTitle: noteTitle
        })
    }
```

这个 addDoc 函数有两个参数。第一个是我们之前创建的 dbInstance。第二个是我们要发送的数据。把它们加在花括号里。

现在，让我们通过创建一个新的便笺来测试这一点。

![Screenshot-2022-01-30-214834](img/765547a3ac36734d00a625dccf3fe92f.png)

因此，添加一个新注释，即注释 1。我们将在我们的 Firebase Firestore 中看到它。

![Screenshot-2022-01-30-214915](img/1a647eec478c4b9ea3beb4de10b4ecaa.png)

## 如何创建注释体

现在让我们创建 Notes 主体。为此，我们将使用之前安装的 React Quill。

```
import ReactQuill from 'react-quill';
import 'react-quill/dist/quill.snow.css';
```

在组件的顶部导入它们。

然后，在输入字段之后返回它。

```
<div className={styles.ReactQuill}>
  <ReactQuill />
</div>
```

我也为反应羽毛笔添加了一些样式。

```
.ReactQuill{
    width: 15rem;
}
```

![Screenshot-2022-01-30-215508](img/d09ae4b782671208545de25f58701014.png)

这是我们现在的产量。

让我们从 React Quill 编辑器中获取值。我们需要一个函数和一个状态。

```
const [noteDesc, setNoteDesc] = useState('')

const addDesc = (value) => {
  setNoteDesc(value)
}
```

将这个函数`addDesc`作为 onChange 事件添加到我们的 React Quill 编辑器中。

```
<ReactQuill 
   onChange={addDesc}
/>
```

因此，无论何时我们在编辑器中输入内容，它都会保存在`noteDesc`状态。

现在，就像我们在 addDoc 函数中发送注释标题一样，我们也需要发送这个。

```
const saveNote = () => {
        addDoc(dbInstance, {
            noteTitle: noteTitle,
            noteDesc: noteDesc
        })
    }
```

现在让我们来测试一下。

添加标题和描述，然后点按“存储注释”。

![Screenshot-2022-01-30-220032](img/7f6e252fa760b52ebaedceeead119243.png)![Screenshot-2022-01-30-220118](img/504b945dcfaad0cdd77aeeba8f91d833.png)

您将看到我们有了一个带有标题和描述的新文档。

但这里的问题是，当我们添加一个新的笔记时，以前的数据仍然在文本字段和 React quill editor 中。我们需要在单击“保存笔记”时清除它。

所以，当我们点击保存注释按钮时，清除状态。把它们清空。

```
const saveNote = () => {
        addDoc(dbInstance, {
            noteTitle: noteTitle,
            noteDesc: noteDesc
        })
            .then(() => {
                setNoteTitle('')
                setNoteDesc('')
            })
    }
```

此外，使用`value`将状态添加到各自的输入中。

```
<input
                        className={styles.input}
                        placeholder='Enter the Title..'
                        onChange={(e) => setNoteTitle(e.target.value)}
                        value={noteTitle}
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill
                            onChange={addDesc}
                            value={noteDesc}
                        />
                    </div>
```

以下是到目前为止的全部代码:

```
import styles from '../../styles/Evernote.module.scss'
import { useState } from 'react';
import { app, database } from '../../firebaseConfig';
import { collection, addDoc } from 'firebase/firestore';
import ReactQuill from 'react-quill';
import 'react-quill/dist/quill.snow.css';

const dbInstance = collection(database, 'notes');
export default function NoteOperations() {
    const [isInputVisible, setInputVisible] = useState(false);
    const [noteTitle, setNoteTitle] = useState('');
    const [noteDesc, setNoteDesc] = useState('')
    const inputToggle = () => {
        setInputVisible(!isInputVisible)
    }

    const addDesc = (value) => {
        setNoteDesc(value)
    }

    const saveNote = () => {
        addDoc(dbInstance, {
            noteTitle: noteTitle,
            noteDesc: noteDesc
        })
            .then(() => {
                setNoteTitle('')
                setNoteDesc('')
            })
    }
    return (
        <>
            <div className={styles.btnContainer}>
                <button
                    onClick={inputToggle}
                    className={styles.button}>
                    Add a New Note
                </button>
            </div>

            {isInputVisible ? (
                <div className={styles.inputContainer}>
                    <input
                        className={styles.input}
                        placeholder='Enter the Title..'
                        onChange={(e) => setNoteTitle(e.target.value)}
                        value={noteTitle}
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill
                            onChange={addDesc}
                            value={noteDesc}
                        />
                    </div>
                    <button
                        onClick={saveNote}
                        className={styles.saveBtn}>
                        Save Note
                    </button>
                </div>
            ) : (
                <></>
            )}
        </>
    )
}
```

以及风格:

```
@import url("https://fonts.googleapis.com/css2?family=Roboto&display=swap");

$dark-red: rgb(119, 27, 27);
$black: black;
$whiteSmoke: whiteSmoke;
$gray: gray;

.container {
    display: flex;
}

.left {
    width: 20rem;
}

.button {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: $black;
    color: $whiteSmoke;
    border: $black;
    font-family: "Roboto";
}

.input {
    width: 15rem;
    height: 2rem;
    outline: none;
    border-radius: 5px;
    border: 1px solid $gray;
    margin: 5px 0;
}

.saveBtn {
    width: 15rem;
    height: 2rem;
    cursor: pointer;
    background-color: $dark-red;
    color: $whiteSmoke;
    border: $dark-red;
    font-family: "Roboto";
}

.ReactQuill{
    width: 15rem;
}
```

## 如何从 Firestore 读取数据

现在，让我们来看看保存在 Firestore 中的笔记。为此，我们需要 getDocs 函数，它就像 addDoc 函数一样。

从 Firestore 导入它们:

```
import { collection, addDoc, getDocs } from 'firebase/firestore';
```

然后，创建一个名为 getNotes 的函数。

```
const getNotes = () => {
        getDocs(dbInstance)
            .then((data) => {
                console.log(data);
            })
    }
```

getDocs 函数将 dbInstance 作为参数，返回集合的数据。

但是我们还需要做一件事。我们需要一个 useEffect 钩子，它将在每次页面加载时运行这个函数。所以，我们来导入添加一下。

```
import { useState, useEffect } from 'react';

useEffect(() => {
    getNotes();
}, [])
```

如果我们检查我们的控制台，我们将得到以下内容:

![Screenshot-2022-01-30-221127](img/f463ed4cd43a59294abb56678a7c66c1.png)

我们得到的数据是不可读的。因此，我们需要对其进行过滤，以获得真正有用的东西。

```
const getNotes = () => {
        getDocs(dbInstance)
            .then((data) => {
                console.log(data.docs.map((item) => {
                    return { ...item.data(), id: item.id }
                }));
            })
    }
```

我们在数据中映射文档，这将返回一个条目。然后，我们将返回项目内部的数据，以及 id。

这将导致以下结果:

![Screenshot-2022-01-30-221407](img/843ccfe7fd7a15ecea524cfd8f6b514f.png)

这就是我们所需要的。让我们将这些数据存储在一个数组状态中。

```
 const [notesArray, setNotesArray] = useState([]);

 const getNotes = () => {
        getDocs(dbInstance)
            .then((data) => {
                setNotesArray(data.docs.map((item) => {
                    return { ...item.data(), id: item.id }
                }));
            })
    }
```

现在，我们需要映射这个`notesArray`来在 UI 中查看我们的数据。

```
<div>
                {notesArray.map((note) => {
                    return (
                        <div>
                            <h3>{note.noteTitle}</h3>
                            <p>{note.noteDesc}</p>
                        </div>
                    )
                })}
            </div>
```

这个 Array.map 函数将针对数组中的每个元素，并返回其内容。

![Screenshot-2022-01-30-221852](img/2a24e6a61c3db9a4651afaddcd962f8b.png)

现在，让我们给如何显示我们的笔记一些样式。

```
 <div className={styles.notesDisplay}>
                {notesArray.map((note) => {
                    return (
                        <div className={styles.notesInner}>
                            <h4>{note.noteTitle}</h4>
                            <p>{note.noteDesc}</p>
                        </div>
                    )
                })}
            </div>
```

我在 div 中添加了一个类名，还添加了一些样式。

```
.notesInner{
    margin-top: 0.5rem;
    border: 1px solid $dark-red;
    border-radius: 10px;
    width: 15rem;
    text-align: center;
    cursor: pointer;
    font-family: "Roboto";
}

.notesInner:hover{
    background-color: rgb(119, 27, 27);
    color: $whiteSmoke;
}
```

![Screenshot-2022-01-30-222429](img/90fe8a2a6aa7a81866720a92391f2fb7.png)

这是我们现在的输出结果:

![Screenshot--836-](img/f852155f76bfb9329dc5d75cd7cdef94.png)

它还具有悬停效果。因此，如果我们将鼠标悬停在某个特定的项目上，它的背景颜色会发生变化。

现在，当我们添加一个注释时，我们需要调用 getNotes 函数。这将确保我们的新笔记自动刷新。所以在 addDoc 函数中添加 getNotes。

```
const saveNote = () => {
        addDoc(dbInstance, {
            noteTitle: noteTitle,
            noteDesc: noteDesc
        })
            .then(() => {
                setNoteTitle('')
                setNoteDesc('')
                getNotes();
            })
    }
```

但是在我们的输出中，我们得到的是带有段落标签的注释描述。这是因为 React Quill 发送标签样式，如标题标签、列表标签等。如果我们使用 React Quill 创建一个列表，它将发送列表标签中的数据。

![Screenshot-2022-01-30-223117](img/ee2806940278cf33d778945d88a82361.png)

如果我们保存这个注释，我们将得到下面的

1.  Tags, because we have added a list in the editor.

![Screenshot-2022-01-30-223206](img/510ea6cc6033f2d6c825a38b9bd20a81.png)

现在，让我们纠正这种输出格式。

我们将使用`dangerouslySetInnerHTML`来呈现带有标签的输出。

```
<div dangerouslySetInnerHTML={{ __html: note.noteDesc }}></div>
```

而现在，我们的输出已经得到了修正。

![Screenshot-2022-01-30-223440](img/ea4a7a1f51dcdc85d79beebcdeb5bd1c.png)

## 在右侧区域显示特定音符。

现在，当我们单击某个注释时，我们需要在正确的容器中显示该注释。

因此，从左侧容器中移除 noteDesc。我们只需要在左边显示标题。

现在，我们需要一个函数，当我们点击某个笔记时，它是这个笔记的 ID。所以，让我们创建函数。

```
 <div className={styles.notesInner}>
   <h4>{note.noteTitle}</h4>
 </div>
```

但是，我们需要主 index.js 文件中的函数，我们将在 NoteOperations 组件中将它作为 props 传递。

```
const getSingleNote = () => {

}
```

并在 NoteOperations 中将其作为道具传递。

```
<NoteOperations getSingleNote={getSingleNote}/>
```

让我们在 NoteOperations 组件的函数体中接收它。

```
export default function NoteOperations({getSingleNote}){
	//The rest of the code here..
}
```

当我们点击左边的任何一个音符时，我们需要调用这个函数。当我们点击它时，我们也传递了特定音符的 ID。

```
<div
  className={styles.notesInner}
  onClick={() => getSingleNote(note.id)}>
   <h4>{note.noteTitle}</h4>
</div>
```

在 getSingleNote 函数中，在我们的主 index.js 文件中，让我们 console.log 我们的 id，看看它是否工作。

```
const getSingleNote = (id) => {
  console.log(id)
}
```

单击字段，我们应该在控制台中获得它的 ID。

![Screenshot-2022-01-30-224717](img/f7f576579e2261ca4f98adc66b9af31b.png)

看，我们快到了。

## 如何根据 ID 显示注释

现在，让我们创建另一个将在正确的容器中呈现的组件。将其命名为 NoteDetails.js。

```
export default function NoteDetails() {
    return (
        <></>
    )
}
```

并在右边的容器 div 中返回这个组件。

```
import NoteDetails from './components/NoteDetails';

<div className={styles.right}>
	<NoteDetails />
</div>
```

我们需要将该 ID 传递给这个组件，但是首先我们需要将它存储在一个状态中。

```
const [ID, setID] = useState(null);

const getSingleNote = (id) => {
   setID(id)
}
```

然后，将它作为 props 传入 NoteDetails 组件。

```
<NoteDetails ID={ID} />
```

我们需要从 NoteDetails 组件中的 firebaseConfig 文件导入数据库和应用程序。还要导入 React Quill 包。

```
import { app, database } from '../../firebaseConfig'
import ReactQuill from 'react-quill';
import 'react-quill/dist/quill.snow.css';
export default function NoteDetails() {
    return (
        <></>
    )
}
```

我们需要在函数体中接收 ID 并销毁它。

```
export default function NoteDetails({ID})
```

现在我们有了 ID，我们必须瞄准那个特定的音符。

我们需要根据那个 ID 来明确显示哪个笔记。为此，我们需要 Firebase Firestore 的 doc 和 getDoc。另外，导入 useEffect 钩子。

```
import { useEffect } from 'react'
import { app, database } from '../../firebaseConfig';
import { doc, getDoc } from 'firebase/firestore'
import ReactQuill from 'react-quill';
import 'react-quill/dist/quill.snow.css';
```

让我们创建一个函数来获取单个音符。

```
const getSingleNote = () => {
        if (ID) {
            const singleNote = doc(database, 'notes', ID)
            const data = getDoc(singleNote)
            console.log({ ...data.data(), id: data.id })
        }
    }
```

我们使用 doc 函数将该笔记作为目标，然后使用 getDoc 将数据存储在变量 data 中。我们也在创建一张支票。只有当我们有 ID 时，这个函数内容才会运行。

把这个函数放到 useEffect 钩子中。另外，在依赖数组中添加 ID。这意味着每当我们的 ID 改变时，这个 useEffect 钩子就会运行。它将刷新数据。

```
useEffect(() => {
  getSingleNote();
}, [ID])
```

![Screenshot-2022-01-30-235528](img/c20c817b9f42aea927ad2504e7445ca3.png)

但是如果我们点击任何一个音符，我们就会得到一个承诺。因此，我们需要使用异步 Await 来处理这个问题。

```
const getSingleNote = async () => {
        if (ID) {
            const singleNote = doc(database, 'notes', ID)
            const data = await getDoc(singleNote)
            console.log({ ...data.data(), id: data.id })
        }
    }
```

如果我们现在点击一个笔记，我们将得到正确的数据。

![Screenshot-2022-01-31-000010](img/0ddd718f00e436fad2dc387fb03e17dd.png)

这张纸条是一个物体。因此，我们需要创建一个对象状态。

```
const [singleNote, setSingleNote] = useState({})
```

然后，设置这个状态中的数据。

```
setSingleNote({ ...data.data(), id: data.id })
```

现在让我们在 UI 中显示我们的笔记。

```
return (
        <>
            <h2>{singleNote.noteTitle}</h2>
            <div dangerouslySetInnerHTML={{ __html: singleNote.noteDesc }}></div>
        </>
    )
```

![Screenshot-2022-01-31-000413](img/5d15e40ae3656740898dffa2b696a2ee.png)

这是我们的输出。单击左侧的注释，它将显示在此处。

现在，如果我们加载我们的页面，我们需要设置一个默认的注释显示在右边。因此，我们需要获取 NoteDetails 组件上的所有注释。我们添加[0]来获取数组的第一个索引。

```
const getNotes = () => {
        getDocs(dbInstance)
            .then((data) => {
                setSingleNote(data.docs.map((item) => {
                    return { ...item.data(), id: item.id }
                })[0]);
            })
    }

    useEffect(() => {
        getNotes();
    }, [])
```

此外，在 NoteDetails 组件中导入所有必要的导入。

如果我们刷新页面，我们将得到右边的第一个音符。

![Screenshot-2022-01-31-001353](img/3016530860b4b5cd1c46fbf4ac2c7d48.png)

## 如何编辑和删除便笺

让我们添加编辑和删除注释的功能。因此，我们需要两个按钮。

```
<div>
   <button>Edit</button>
    <button>Delete</button>
 </div>
```

让我们添加一些造型。

```
<button className={styles.editBtn}>Edit</button>
<button className={styles.deleteBtn}>Delete</button>
```

```
.editBtn, .deleteBtn{
    width: 5rem;
    height: 2rem;
    background-color: rgb(119, 27, 27);
    color: $whiteSmoke;
    border: none;
    cursor: pointer;
    margin: 10px 10px 10px 0;
}
```

我们现在有两个按钮，用于编辑和删除。

![Screenshot-2022-01-31-003038](img/e1989a081b4c9994d544707bd817a05b.png)

让我们添加编辑功能。既然我们有身份证，我们就可以使用它。

我们需要两个输入和一个按钮，当我们单击编辑按钮时，它们将是可见的。

```
const [isEdit, setIsEdit] = useState(false);
```

我们需要一个隐藏和显示输入字段的状态。以及一个将状态设置为真函数。

```
const getEditData = () => {
  setIsEdit(true);
}
```

如果这个状态为真，我们将显示我们的输入和按钮。但是首先，让我们创建它们。

```
{isEdit ? (
                <div className={styles.inputContainer}>
                    <input
                        className={styles.input}
                        placeholder='Enter the Title..'
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill />
                    </div>
                    <button
                        className={styles.saveBtn}>
                        Update Note
                    </button>
                </div>
            ) : (
                <></>
            )}
```

我们还有一个条件。如果`isEdit`为真，我们将在输入字段中显示数据。如果是假的，我们什么都不会显示。

现在，让我们设置值。

```
{isEdit ? (
                <div className={styles.inputContainer}>
                    <input
                        className={styles.input}
                        placeholder='Enter the Title..'
                        value={singleNote.noteTitle}
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill
                            value={singleNote.noteDesc}
                        />
                    </div>
                    <button
                        className={styles.saveBtn}>
                        Update Note
                    </button>
                </div>
            ) : (
                <></>
            )}
```

但是如果我们改变标题和笔记的内容，它们不会改变。所以，我们需要让他们处于一种状态。

```
const [noteTitle, setNoteTitle] = useState('');
const [noteDesc, setNoteDesc] = useState('');
```

```
<input
                        className={styles.input}
                        placeholder='Enter the Title..'
                        onChange={(e) => setNoteTitle(e.target.value)}
                        value={singleNote.noteTitle}
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill
                            onChange={setNoteDesc}
                            value={singleNote.noteDesc}
                        />
                    </div>
```

但是，这些值仍然不会改变，因为 onChange 的状态和值是不同的。这意味着如果我们使用 setNoteTitle 或 setNoteDesc 设置数据，这些值应该是它们各自的状态。

```
<div className={styles.inputContainer}>
                    <input
                        className={styles.input}
                        placeholder='Enter the Title..'
                        onChange={(e) => setNoteTitle(e.target.value)}
                        value={noteTitle}
                    />
                    <div className={styles.ReactQuill}>
                        <ReactQuill
                            onChange={setNoteDesc}
                            value={noteDesc}
                        />
                    </div>
```

我们可以在 getEditData 函数中设置状态。

```
const getEditData = () => {
        setIsEdit(true);
        setNoteTitle(singleNote.noteTitle);
        setNoteDesc(singleNote.noteDesc)
    }
```

现在，如果我们单击 edit，我们应该在输入字段和文本编辑器中获得我们的数据。

![Screenshot-2022-01-31-005800](img/23be368e4b8df7eee67fdf6a77914ec2.png)

现在，让我们使用 updateDoc 函数来更新所选字段。

```
import { 
    doc, 
    getDoc, 
    getDocs, 
    collection,
    updateDoc
} from 'firebase/firestore'
```

从 Firestore 导入 updateDoc。

创建一个函数，当文档被点击时更新它。

```
const editNote = (id) => {
        const collectionById = doc(database, 'notes', id)

        updateDoc(collectionById, {
            noteTitle: noteTitle,
            noteDesc: noteDesc,
        })
    }
```

当我们单击按钮时，我们需要将这个 id 作为参数传递。将此功能添加到更新注释按钮。

```
<button
                        onClick={() => editNote(singleNote.id)}
                        className={styles.saveBtn}>
                        Update Note
                    </button>
```

更改便笺标题或便笺正文，它将被编辑。

![Screenshot-2022-01-31-010422](img/8eab79b64fc9fc79036d72cf1f5ae806.png)

但是我们也需要改变 UI 中的数据。因此，我们将使用一个名为 window.location.reload 的方法来重新加载我们的页面。

```
const editNote = (id) => {
        const collectionById = doc(database, 'notes', id)

        updateDoc(collectionById, {
            noteTitle: noteTitle,
            noteDesc: noteDesc,
        })
            .then(() => {
                window.location.reload()
            })
    }
```

最后，让我们添加删除函数来删除一个注释。

就像 editNote 函数一样，我们将有一个 deleteNote 函数。

```
const deleteNote = (id) => {
        const collectionById = doc(database, 'notes', id)

        deleteDoc(collectionById)
            .then(() => {
                window.location.reload()
            })
    }
```

这个函数有一个`collectionById`来定位要删除的文档，然后使用`deleteDoc`函数删除它。

将该函数添加到 Delete 按钮，并将 singleNote.id 作为其 id 传递。

```
<button
    className={styles.deleteBtn}
    onClick={() => deleteNote(singleNote.id)}
  >Delete
</button>
```

如果我们现在单击“删除”按钮，该注释将不再存在。

恭喜你——你创建了一个 EverNote 克隆版！

## 包扎

所以，这就是关于如何使用 NextJS 和 Firebase 构建 Evernote 克隆的全部内容。

你可以通过创建你认为合适的更好的 UI 和 UX 设计来改进这个项目。

你可以在我的 YouTube 频道上的[查看我关于同一主题的视频，让我们使用 NEXT JS 和 Firebase](https://youtu.be/3446IAFr1Tw) 来构建一个 Evernote 克隆。

你可以在这里找到完整的代码:[https://github.com/nishant-666/Evernote-Next-Alt](https://github.com/nishant-666/Evernote-Next-Alt)

感谢阅读！

> 快乐学习。