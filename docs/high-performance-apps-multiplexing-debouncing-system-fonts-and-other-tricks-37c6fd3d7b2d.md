# 高性能应用:多路复用、去抖动、系统字体和其他技巧

> 原文：<https://www.freecodecamp.org/news/high-performance-apps-multiplexing-debouncing-system-fonts-and-other-tricks-37c6fd3d7b2d/>

作者:阿蒂拉·法西纳

# 高性能应用:多路复用、去抖动、系统字体和其他技巧

![1*Y9Wf1Py9tQd3nc4l0AFsCQ](img/ed37ee40f77071d14faf7740150f0eb9.png)

这里有一些客户端应用程序的性能提示，您可以立即开始使用。

这些将显著提升你的应用程序的感知性能。其中大多数只需要快速调整你的应用程序。

### 预载您的资源

是一种让你的浏览器知道特定资源很重要的方式。这样，您的浏览器将尽快获取资源。然后它将把它存储在本地，直到在 DOM 中找到期望的引用。

以下是使用带有此属性的`link`的一些示例:

`as`属性在这里是强制的，因为它告诉浏览器它正在获取什么文件类型。这样，它可以解释请求并添加适当的头。否则，您的请求会有不正确的`mime/type`,因此您的浏览器将无法解析它。

顺便说一下，`mime/type`是开发者在 web 上使用的文件类型声明。这类似于桌面操作系统上的文件扩展名。如果您的`mime/type`不正确，浏览器将不知道如何解析该文件。

字体文件的预加载有点棘手。以下是一些需要记住的事情:

*   `crossorigin`—[W3C](https://en.wikipedia.org/wiki/World_Wide_Web_Consortium)要求字体获取是匿名的。简而言之，这意味着即使请求来自同一个域，它也会被视为跨来源请求。
*   `type` —指定浏览器获取字体时应使用的格式。

另外，确保只将第一种格式添加到您的`font-face`声明中。预加载多种字体格式不符合最佳实践，是不良的 UX，并且浪费用户的带宽。

你可以[在这里](https://caniuse.com/#search=preload)阅读更多关于预加载的信息。

### 使用操作系统特定的字体

通过使用系统字体，可以模拟用户操作系统的外观和感觉。这样，您的应用程序更有可能看起来像本机应用程序，同时为您的用户省去下载更多资源的麻烦。

让我们更仔细地分析一下这些声明:

*   *苹果系统*:顾名思义，这些目标是 OSX/iOS 相关系统
*   *system-ui* :针对系统字体，与系统无关
*   *闪烁 MAC system font*:chrome ' s font on MAC OS
*   *Segoe UI*:Windows/Windows Phone
*   机器人:安卓

这个解决方案被广泛使用，尽管许多开发人员还不知道它。例如，在撰写本文时，它被用于:

*   开源代码库
*   Wordpress
*   引导程序
*   中等
*   《人鬼情未了》
*   时代周刊

可能还有一些我还没听说过的。

### 谴责并抑制对服务器的呼叫

有些事件被触发的次数比我们预期的要多很多。例如:调整大小、滚动、按键/keydown/keyup 或更改。

例如，调整大小和滚动，每隔个像素就会在*触发。如果您只想在断点处调整一些元素，或者在用户向下滚动页面时向标题添加一个类，那么这就太麻烦了。*

例如，如果您有一个自动完成功能，您不希望每次按键时都触发。在大多数情况下，最好在第三个字符后开始自动完成。尤其是如果你打算为此获取信息的话。

**去抖**保持你的触发器，直到事件停止触发一段给定的时间(通常是 500 毫秒)。

**Throttle** 如果它试图比给定的时间间隔(通常为 25o 毫秒)更频繁地触发，它会阻止你的触发器。

### 使用异步/延迟

还记得那个古老的`window.onload`函数吗？或者把所有的脚本都移到 HTML 的底部？是的，嗯，`async`和`defer`在这里给你一些更好的选择。

**Async** 将在 HTML 解析期间下载您的脚本。它将异步运行它(如果可能的话)——不管它是在哪里声明的。

**Defer** 也会在 HTML 解析期间下载你的脚本，尽管它只会在解析器完成后尝试运行你的脚本。此外，声明多个延迟脚本保证了它们将按声明顺序执行。

```
<script async src="./my-async-script.js"></script><script defer src="./my-deferred-script.js"></script>
```

### 数据:uri 和

在添加图标或小图片文件时，一个有趣的技巧是使用`data-uri`。一个`data` URL 通常被编码为`base64`，它提供了一种将文件直接嵌入 DOM 的简单方法。以类似的方式，您可以添加`<s` vg >作为标记。这样，浏览器将解析和呈现您的 SVG 图像。

注意，使用`<s` vg >而不是嵌入`as an` < img >或图标字体会带来超出本文范围的其他功能。

将文件直接添加到您的标记中，而不是引用它们，每次可以节省一个 HTTP 请求。当你的文件很小，不值得往返服务器的时候，这很好。尤其是在移动网络上，因为握手会非常昂贵。

### 使用多路传输

如果您的服务器已经在使用 HTTP2，嵌入文件可能不值得。这是因为 HTTP2 有一个叫做**多路复用的特性。**

这意味着您的浏览器可以在一个 TCP 连接中发送多个请求和接收多个响应。因此，与 DNS 查找和[握手](https://en.wikipedia.org/wiki/Handshaking)相关的工作量对于来自相同服务器的文件来说是节省的。

另外，HTTP2 还为你提供了**服务器推送。**这意味着甚至在用户请求之前就可以发送文件。这显著提高了感知性能。

我希望这些技巧能帮助你提高应用程序的感知性能。如果你觉得这篇文章有帮助，给我一些掌声？。你也可以在 T [witter 上给我反馈。](https://twitter.com/atilafassina)

### 进一步阅读

#### On rel =预载:

*   [SmashingMagazine —预加载它对什么有好处](https://www.smashingmagazine.com/2016/02/preload-what-is-it-good-for/)
*   [扎克·莱瑟曼—预载](https://www.zachleat.com/web/preload/)

#### 在系统字体上:

*   [Bitsofcode——新的系统字体堆栈？](https://bitsofco.de/the-new-system-font-stack/)
*   [Normalize.css —第 665 期](https://github.com/necolas/normalize.css/issues/665)