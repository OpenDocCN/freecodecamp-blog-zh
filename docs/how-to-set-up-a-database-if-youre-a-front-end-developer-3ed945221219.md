# 如果你是前端开发人员，如何设置数据库

> 原文：<https://www.freecodecamp.org/news/how-to-set-up-a-database-if-youre-a-front-end-developer-3ed945221219/>

安德里亚·赞恩

# 如果你是前端开发人员，如何设置数据库

![1*d_hx4BxGZ9qYODhnTn-Bjg](img/5bd03c1b50b8942e32153d6689a511c9.png)

最近有人问我，前端开发者保存用户数据最简单的方法是什么？所以我将解释如何做到这一点。

### 设置数据库

我们首先需要的是一个实际的数据库。可以前往 [mlab](https://mlab.com) 免费一个。注册后，在 MongoDB 部署选项卡中点击**创建新的***T5。沙盒数据库是免费的，所以这是我们将要使用的一个。*

一旦我们创建了数据库，我们需要创建一个帐户，以便我们可以验证自己。点击数据库名称，然后**用户、** 和**添加数据库用户**。记下您选择的用户名和密码，因为我们稍后会用到它们。

在数据库页面的顶部，您应该会看到一个 MongoDB URI。这是我们数据库的网址。数据库的 URI 就像网页的 URL。按照惯例，MongoDB URI 如下:

```
mongodb://<dbuser>:<dbpassword>@<host&gt;:<port>/<dbname>
```

例如，我的是:

```
mongodb://admin:superSecretPassword@ds111885.mlab.com:11885/medium
```

### 设置服务器

我们将在后端使用 Node。为了避免设置它，你可以通过点击这里的来克隆我的项目

看看我提供的起始`server.js`文件:

我们从导入`express`开始——这是我们将用来处理对服务器的请求的库。

我们需要`use(require(cors))`来允许跨域请求。这些是从一个域上的网站向另一个域上的服务器发出的请求。
`app.use(require('body-parser').json())`自动为我们解析对 JSON 的请求。

然后我们向`get`方法传递我们想要处理的路由和将处理它的回调。这意味着每当有人打开我们网站的页面`/`时，请求将由回调处理。基域是隐式的，所以如果你的域是 http://shiny-koala.glitch.com，路由`/about`就是 http://shiny-koala.glitch.com/about*。*

准确地说，当我说“打开页面”时，我的意思是它使用`GET`方法向我们的服务器发出请求。Http 方法只是您可以向服务器发出的请求类型。我们将只使用以下内容:

*   这个方法用于从服务器获取资源。例如，当你打开脸书时，它会加载所需的 HTML、CSS 和 JavaScript。
*   此方法用于在服务器上创建资源。例如，当你在脸书上发布一些东西时，你在那篇文章中写的信息会通过一个`POST`请求发送到脸书的服务器上。
*   此方法用于更新服务器上的资源。例如，当你编辑一篇文章时，你的编辑通过一个`PUT`请求被发送到脸书的服务器。

`app.post`和`app.put`的工作方式和`app.get`完全一样，但是处理 POST 和 PUT 方法，而不是 GET。

### 按指定路线发送

在开发服务器时，您需要做一些测试。要运行 HTTP 请求，您可以使用方便的站点 [REST test test](https://resttesttest.com/) 或[失眠症](https://insomnia.rest/)应用程序。

要检查 Glitch 应用程序的 URL，请单击**显示**按钮。

到目前为止，我们只使用了路线`/`。但是我们希望存储不同用户的不同信息，所以我们需要为每个用户选择不同的路线。
比如:`/ZaninAndrea`和`/JohnGreen`

现在我们有一个问题:我们不可能编码每一条路线，因为这不是一个非常可扩展的方法。我们需要的是**路线参数。**我们将只编码一条路线:`/:user`

冒号告诉 Express 捕捉任何以`/`开头，然后只有字母数字字符的路线。

一些例子:

*   `/ZaninAndrea`会被抓住
*   `/Johnny45`会被抓住
*   `/alex/score`会不会是**而不是**被抓

然后我们可以在变量`request.params.user`中检索`user`的值

我们的服务器现在响应每个回显用户名的查询。

### 向数据库添加数据

我们知道用户是谁，现在我们希望能够存储一些关于他的信息。

为了查询数据库，我们将使用`mongodb`库。您可以通过两种方式安装它:

```
npm install mongodb --save
```

或者如果你正在使用 Glitch，进入`package.json`文件并点击按钮**添加包**。

让我们加载库并将 MongoDB URI 存储在一个变量中:

URI 是非常敏感的信息-它是访问您的数据库所需的全部信息。最好放在别人看不到的`.env`文件里。

毛刺会自动将变量从`.env`文件加载到`process.env`变量中。

到数据库的连接是一个异步操作，因此我们需要将所有的服务器设置包装在一个回调中，如下所示:

数据库被组织成集合，集合包含文档(基本上是 JSON 文件)。所以让我们连接到`user`集合(它将在我们第一次访问它时被创建)。

首先，我们将处理`POST`路线。这是我们第一次添加用户数据时将使用的方法。然后我们将使用`PUT`路由来更新它。

`collection.insertOne`方法向集合中添加一个新文档。在我们的例子中，每个用户都有自己的文档。

`{ ...request.body, user : request.params.user }`利用[传播操作符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator)来合并通过请求体提供的数据和通过 URL 提供的用户数据。

结果是将存储在集合中的文档。

第二个参数是一个回调，简单地通知用户操作的结果。

### 从数据库获取数据

现在我们在服务器上有了一些数据，我们希望能够读取这些数据。我们使用`GET`方法来做到这一点。

这一次，第一个参数是一个过滤器，告诉数据库只向我们发送具有正确用户属性的文档。

文档以数组的形式返回给用户，因为理论上可能有多个文档具有该用户属性。我们有责任确保这种情况不会发生。

### 更新数据库中的数据

最后但同样重要的是我们用来更新已经存在的用户的`PUT`方法。

第一个参数是一个过滤器，就像我们在`GET`方法中使用的一样。

第二个参数是一个更新文档——你可以在这里阅读更多关于它们的内容[。在我们的例子中，我们告诉数据库将用户传递的数据与已经存在的数据合并。](https://docs.mongodb.com/manual/reference/method/db.collection.update/#update-parameter)

但是要小心，因为嵌套的参数将被替换而不是合并。

### 告别

这远不是一个关于数据库和后端编程的完整指南，但它足以让您开始并推动个人项目。

我可能会在以后的文章中讨论身份验证。在此之前，不要用它来存储敏感数据。

你可以在这里修改完整的项目[，你将需要自己的数据库，如果你还没有创建一个，回到**设置数据库**一节。](https://glitch.com/edit/#!/remix/bush-vegetable)

如果你喜欢这篇文章，请给它一些掌声，让更多的人看到它。谢谢大家！